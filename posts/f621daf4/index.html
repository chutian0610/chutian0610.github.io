<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png"><link rel="mask-icon" href="/images/logo.svg" color="#222"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha256-XOqroi11tY4EFQMR9ZYwZWKj5ZXiftSx36RRuC3anlA=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancyapps-ui/5.0.31/fancybox/fancybox.css" integrity="sha256-gkQVf8UKZgQ0HyuxL/VnacadJ+D2Kox2TCEBuNQg5+w=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/themes/blue/pace-theme-fill-left.css"><script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script><script class="next-config" data-name="main" type="application/json">{"hostname":"www.victorchu.info","root":"/","images":"/images","scheme":"Muse","darkmode":false,"version":"8.20.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12,"onmobile":true},"copycode":{"enable":true,"style":"flat"},"fold":{"enable":true,"height":500},"bookmark":{"enable":true,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":true,"pangu":true,"comments":{"style":"tabs","active":"waline","storage":false,"lazyload":false,"nav":null,"activeClass":"waline"},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"algolia":{"appID":"X9UOD4FSUP","apiKey":"fa32db1f02073025c69da8ebad0a6aa6","indexName":"hexo-next-blog","hits":{"per_page":10}}}</script><script src="/js/config.js"></script><meta name="description" content="Shell 脚本（shell script），是一种为 shell 编写的脚本程序。Linux 的 Shell 种类众多，常见的有：  Bourne Shell（&#x2F;usr&#x2F;bin&#x2F;sh或&#x2F;bin&#x2F;sh） Bourne Again Shell（&#x2F;bin&#x2F;bash） C Shell（&#x2F;usr&#x2F;bin&#x2F;csh） K Shell（&#x2F;usr&#x2F;bin&#x2F;ksh） Shell for Root（&#x2F;sbin&#x2F;sh）"><meta property="og:type" content="article"><meta property="og:title" content="shell 脚本速查"><meta property="og:url" content="https://www.victorchu.info/posts/f621daf4/index.html"><meta property="og:site_name" content="代码之旅"><meta property="og:description" content="Shell 脚本（shell script），是一种为 shell 编写的脚本程序。Linux 的 Shell 种类众多，常见的有：  Bourne Shell（&#x2F;usr&#x2F;bin&#x2F;sh或&#x2F;bin&#x2F;sh） Bourne Again Shell（&#x2F;bin&#x2F;bash） C Shell（&#x2F;usr&#x2F;bin&#x2F;csh） K Shell（&#x2F;usr&#x2F;bin&#x2F;ksh） Shell for Root（&#x2F;sbin&#x2F;sh）"><meta property="og:locale" content="zh_CN"><meta property="article:published_time" content="2019-03-09T13:48:26.000Z"><meta property="article:modified_time" content="2024-10-31T09:41:51.264Z"><meta property="article:author" content="Victor Chu"><meta property="article:tag" content="Shell"><meta property="article:tag" content="Scripts"><meta name="twitter:card" content="summary"><link rel="canonical" href="https://www.victorchu.info/posts/f621daf4/"><script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://www.victorchu.info/posts/f621daf4/","path":"/posts/f621daf4/","title":"shell 脚本速查"}</script><script class="next-config" data-name="calendar" type="application/json">""</script><title>shell 脚本速查 | 代码之旅</title><script src="/js/third-party/analytics/baidu-analytics.js"></script><script async src="https://hm.baidu.com/hm.js?277fc29fa80de77c97f4f62b69e94233"></script><link rel="dns-prefetch" href="walineui.victorchu.info"><link rel="stylesheet" type="text/css" href="/css/injector/main.css"><link rel="preload" as="style" href="/css/injector/light.css"><link rel="preload" as="style" href="/css/injector/dark.css"><noscript><link rel="stylesheet" href="/css/noscript.css"></noscript><link rel="alternate" href="/atom.xml" title="代码之旅" type="application/atom+xml"><style>.darkmode--activated{--body-bg-color:#282828;--content-bg-color:#333;--card-bg-color:#555;--text-color:#ccc;--blockquote-color:#bbb;--link-color:#ccc;--link-hover-color:#eee;--brand-color:#ddd;--brand-hover-color:#ddd;--table-row-odd-bg-color:#282828;--table-row-hover-bg-color:#363636;--menu-item-bg-color:#555;--btn-default-bg:#222;--btn-default-color:#ccc;--btn-default-border-color:#555;--btn-default-hover-bg:#666;--btn-default-hover-color:#ccc;--btn-default-hover-border-color:#666;--highlight-background:#282b2e;--highlight-foreground:#a9b7c6;--highlight-gutter-background:#34393d;--highlight-gutter-foreground:#9ca9b6}.darkmode--activated img{opacity:.75}.darkmode--activated img:hover{opacity:.9}.darkmode--activated code{color:#69dbdc;background:0 0}button.darkmode-toggle{z-index:9999}.darkmode-ignore,img{display:flex!important}.beian img{display:inline-block!important}</style></head><body itemscope itemtype="http://schema.org/WebPage" class="use-motion"><div class="headband"></div><main class="main"><div class="column"><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏" role="button"><span class="toggle-line"></span> <span class="toggle-line"></span> <span class="toggle-line"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><i class="logo-line"></i><p class="site-title">代码之旅</p><i class="logo-line"></i></a><p class="site-subtitle" itemprop="description">I love Coding !</p></div><div class="site-nav-right"><div class="toggle popup-trigger" aria-label="搜索" role="button"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class="site-nav"><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签<span class="badge">119</span></a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类<span class="badge">87</span></a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档<span class="badge">225</span></a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索</a></li></ul></nav><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"></div><span class="popup-btn-close" role="button"><i class="fa fa-times-circle"></i></span></div><div class="search-result-container"><div class="algolia-stats"><hr></div><div class="algolia-hits"></div><div class="algolia-pagination"></div></div></div></div></header><aside class="sidebar"><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class="sidebar-nav"><li class="sidebar-nav-toc">文章目录</li><li class="sidebar-nav-overview">站点概览</li></ul><div class="sidebar-panel-container"><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95"><span class="nav-number">1.</span> <span class="nav-text">基础语法</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%B3%A8%E9%87%8A"><span class="nav-number">1.1.</span> <span class="nav-text">注释</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8F%98%E9%87%8F"><span class="nav-number">1.2.</span> <span class="nav-text">变量</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8F%98%E9%87%8F%E7%B1%BB%E5%9E%8B"><span class="nav-number">1.2.1.</span> <span class="nav-text">变量类型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Shell-%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="nav-number">1.2.2.</span> <span class="nav-text">Shell 字符串</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#shell-%E6%95%B0%E7%BB%84"><span class="nav-number">1.2.3.</span> <span class="nav-text">shell 数组</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8F%82%E6%95%B0%E4%BC%A0%E9%80%92"><span class="nav-number">1.3.</span> <span class="nav-text">参数传递</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%80%BC"><span class="nav-number">1.4.</span> <span class="nav-text">字符串值</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#shell-%E5%9F%BA%E6%9C%AC%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="nav-number">1.5.</span> <span class="nav-text">shell 基本运算符</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AE%97%E6%9C%AF%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="nav-number">1.5.1.</span> <span class="nav-text">算术运算符</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%B3%E7%B3%BB%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="nav-number">1.5.2.</span> <span class="nav-text">关系运算符</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B8%83%E5%B0%94%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="nav-number">1.5.3.</span> <span class="nav-text">布尔运算符</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%80%BB%E8%BE%91%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="nav-number">1.5.4.</span> <span class="nav-text">逻辑运算符</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="nav-number">1.5.5.</span> <span class="nav-text">字符串运算符</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E6%B5%8B%E8%AF%95%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="nav-number">1.5.6.</span> <span class="nav-text">文件测试运算符</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%8E%A7%E5%88%B6%E7%BB%93%E6%9E%84"><span class="nav-number">1.6.</span> <span class="nav-text">控制结构</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#if-else"><span class="nav-number">1.6.1.</span> <span class="nav-text">if-else</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#for"><span class="nav-number">1.6.2.</span> <span class="nav-text">for</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#while-%E8%AF%AD%E5%8F%A5"><span class="nav-number">1.6.3.</span> <span class="nav-text">while 语句</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%97%A0%E9%99%90%E5%BE%AA%E7%8E%AF"><span class="nav-number">1.6.4.</span> <span class="nav-text">无限循环</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#until-%E5%BE%AA%E7%8E%AF"><span class="nav-number">1.6.5.</span> <span class="nav-text">until 循环</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#case-%E2%80%A6-esac"><span class="nav-number">1.6.6.</span> <span class="nav-text">case … esac</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%B7%B3%E5%87%BA%E5%BE%AA%E7%8E%AF"><span class="nav-number">1.6.7.</span> <span class="nav-text">跳出循环</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#shell-%E5%87%BD%E6%95%B0"><span class="nav-number">1.7.</span> <span class="nav-text">shell 函数</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BF%94%E5%9B%9E%E5%80%BC%E5%A4%84%E7%90%86"><span class="nav-number">1.7.1.</span> <span class="nav-text">返回值处理:</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%87%BD%E6%95%B0%E5%8F%82%E6%95%B0"><span class="nav-number">1.7.2.</span> <span class="nav-text">函数参数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#import"><span class="nav-number">1.7.3.</span> <span class="nav-text">import</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#local-%E5%8F%98%E9%87%8F"><span class="nav-number">1.7.4.</span> <span class="nav-text">local 变量</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AE%A1%E9%81%93"><span class="nav-number">1.8.</span> <span class="nav-text">管道</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AE%A1%E9%81%93%E8%BF%94%E5%9B%9E%E5%80%BC"><span class="nav-number">1.8.1.</span> <span class="nav-text">管道返回值</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#xargs"><span class="nav-number">1.8.2.</span> <span class="nav-text">xargs</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#shell-%E8%BE%93%E5%85%A5-%E8%BE%93%E5%87%BA%E9%87%8D%E5%AE%9A%E5%90%91"><span class="nav-number">1.9.</span> <span class="nav-text">shell 输入&#x2F;输出重定向</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Here-Document"><span class="nav-number">1.9.1.</span> <span class="nav-text">Here Document</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#dev-null-%E6%96%87%E4%BB%B6"><span class="nav-number">1.9.2.</span> <span class="nav-text">&#x2F;dev&#x2F;null 文件</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#shell-%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4"><span class="nav-number">1.10.</span> <span class="nav-text">shell 常用命令</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#set"><span class="nav-number">1.10.1.</span> <span class="nav-text">set</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#echo"><span class="nav-number">1.10.2.</span> <span class="nav-text">echo</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#printf"><span class="nav-number">1.10.3.</span> <span class="nav-text">printf</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#test"><span class="nav-number">1.10.4.</span> <span class="nav-text">test</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#declare"><span class="nav-number">1.10.5.</span> <span class="nav-text">declare</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#trap"><span class="nav-number">1.10.6.</span> <span class="nav-text">trap</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Bash-%E9%85%8D%E7%BD%AE"><span class="nav-number">2.</span> <span class="nav-text">Bash 配置</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#IFS"><span class="nav-number">2.1.</span> <span class="nav-text">IFS</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%85%8D%E7%BD%AE%E9%A1%B9%E5%8F%82%E6%95%B0%E7%BB%88%E6%AD%A2%E7%AC%A6"><span class="nav-number">2.2.</span> <span class="nav-text">配置项参数终止符 --</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%BC%96%E7%A8%8B%E8%A7%84%E8%8C%83"><span class="nav-number">3.</span> <span class="nav-text">编程规范</span></a></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" alt="Victor Chu" src="/images/victor-blog-head.webp"><p class="site-author-name" itemprop="name">Victor Chu</p><div class="site-description" itemprop="description">blog about programming.</div></div><div class="site-state-wrap animated"><nav class="site-state"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">225</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/"><span class="site-state-item-count">87</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"><a href="/tags/"><span class="site-state-item-count">119</span> <span class="site-state-item-name">标签</span></a></div></nav></div><div class="links-of-author animated"><span class="links-of-author-item"><a href="https://github.com/chutian0610" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;chutian0610" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a> </span><span class="links-of-author-item"><a href="mailto:victorchu0610@outlook.com" title="E-Mail → mailto:victorchu0610@outlook.com" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a> </span><span class="links-of-author-item"><a href="https://www.zhihu.com/people/victorchu" title="Zhihu → https:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;victorchu" rel="noopener me" target="_blank"><i class="fab fa-zhihu fa-fw"></i>Zhihu</a> </span><span class="links-of-author-item"><a href="/images/Wechat.webp" title="WeChat → &#x2F;images&#x2F;Wechat.webp" rel="noopener me"><i class="fa-brands fa-weixin fa-fw"></i>WeChat</a></span></div></div></div></div><div class="sidebar-inner sidebar-blogroll"><div class="links-of-blogroll animated"><div class="links-of-blogroll-title"><i class="fa fa-globe fa-fw"></i> 链接</div><ul class="links-of-blogroll-list"><li class="links-of-blogroll-item"><a href="https://www.tpfuture.top/" title="https:&#x2F;&#x2F;www.tpfuture.top&#x2F;" rel="noopener" target="_blank">一水轩</a></li></ul></div></div><div class="sidebar-inner sidebar-post-related"><div class="animated"><div class="links-of-blogroll-title"><i class="fa fa-signs-post fa-fw"></i> 相关文章</div><ul class="popular-posts"><li class="popular-posts-item"><a class="popular-posts-link" href="/posts/c7b6c829/" rel="bookmark"><time class="popular-posts-time">2016-11-23</time><br>My Effective Zsh</a></li><li class="popular-posts-item"><a class="popular-posts-link" href="/posts/68f70fec/" rel="bookmark"><time class="popular-posts-time">2019-03-10</time><br>shell 脚本和snippets</a></li><li class="popular-posts-item"><a class="popular-posts-link" href="/posts/54424c49/" rel="bookmark"><time class="popular-posts-time">2019-08-08</time><br>shell脚本选项处理</a></li></ul></div></div></aside></div><div class="main-inner post posts-expand"><div class="post-block"><article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://www.victorchu.info/posts/f621daf4/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/victor-blog-head.webp"><meta itemprop="name" content="Victor Chu"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="代码之旅"><meta itemprop="description" content="blog about programming."></span><span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork"><meta itemprop="name" content="shell 脚本速查 | 代码之旅"><meta itemprop="description" content=""></span><header class="post-header"><h1 class="post-title" itemprop="name headline">shell 脚本速查</h1><div class="post-meta-container"><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2019-03-09 21:48:26" itemprop="dateCreated datePublished" datetime="2019-03-09T21:48:26+08:00">2019-03-09</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i> </span><span class="post-meta-item-text">更新于</span> <time title="修改时间：2024-10-31 17:41:51" itemprop="dateModified" datetime="2024-10-31T17:41:51+08:00">2024-10-31</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Shell/" itemprop="url" rel="index"><span itemprop="name">Shell</span></a> </span></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-comment"></i> </span><span class="post-meta-item-text">Waline：</span> <a title="waline" href="/posts/f621daf4/#waline" itemprop="discussionUrl"><span class="post-comments-count waline-comment-count" data-path="/posts/f621daf4/" itemprop="commentCount"></span> </a></span><span class="post-meta-item" title="阅读次数"><span class="post-meta-item-icon"><i class="far fa-eye"></i> </span><span class="post-meta-item-text">阅读次数：</span> <span class="waline-pageview-count" data-path="/posts/f621daf4/"></span> </span><span class="post-meta-break"></span> <span class="post-meta-item" title="本文字数"><span class="post-meta-item-icon"><i class="far fa-file-word"></i> </span><span class="post-meta-item-text">本文字数：</span> <span>21k</span> </span><span class="post-meta-item" title="阅读时长"><span class="post-meta-item-icon"><i class="far fa-clock"></i> </span><span class="post-meta-item-text">阅读时长 &asymp;</span> <span>35 分钟</span></span></div></div></header><div class="post-body" itemprop="articleBody"><p>Shell 脚本（shell script），是一种为 shell 编写的脚本程序。Linux 的 Shell 种类众多，常见的有：</p><ol><li>Bourne Shell（/usr/bin/sh或/bin/sh）</li><li>Bourne Again Shell（/bin/bash）</li><li>C Shell（/usr/bin/csh）</li><li>K Shell（/usr/bin/ksh）</li><li>Shell for Root（/sbin/sh）</li><li>Z Shell /usr/bin/zsh)</li></ol><p>由于易用和免费，Bash 在日常工作中被广泛使用。同时，Bash 也是大多数Linux 系统默认的 Shell。</p><span id="more"></span><p>下面来看一个简单的脚本:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;Hello World !&quot;</span></span><br></pre></td></tr></table></figure><blockquote><p><code>#!</code> 是一个约定的标记，它告诉系统这个脚本需要什么解释器来执行，即使用哪一种 Shell。</p></blockquote><p>运行 Shell 脚本有两种方法：</p><ol><li>作为可执行程序. 将上面的代码保存为 <a target="_blank" rel="noopener" href="http://test.sh">test.sh</a>，并赋予可执行权限:</li></ol><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">chmod</span> +x ./test.sh  <span class="comment">#使脚本具有执行权限</span></span><br><span class="line">./test.sh  <span class="comment">#执行脚本</span></span><br></pre></td></tr></table></figure><ol start="2"><li>作为解释器参数.这种运行方式是，直接运行解释器，其参数就是 shell 脚本的文件名，如：</li></ol><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash test.sh</span><br></pre></td></tr></table></figure><h1 id="基础语法">基础语法</h1><h2 id="注释">注释</h2><p>shell 脚本中以<code>#</code> 开头的行是单行注释，也支持多行注释:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">:&lt;&lt;<span class="string">EOF</span></span><br><span class="line"><span class="string">注释内容...</span></span><br><span class="line"><span class="string">注释内容...</span></span><br><span class="line"><span class="string">注释内容...</span></span><br><span class="line"><span class="string">EOF</span></span><br></pre></td></tr></table></figure><p>EOF 也可以使用其他符号:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">:&lt;&lt;!</span><br><span class="line">注释内容...</span><br><span class="line">注释内容...</span><br><span class="line">注释内容...</span><br><span class="line">!</span><br></pre></td></tr></table></figure><h2 id="变量">变量</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var=<span class="string">&quot;dsds&quot;</span></span><br></pre></td></tr></table></figure><ol><li>变量名和等号之间不能有空格</li><li>命名只能使用英文字母，数字和下划线，首个字符不能以数字开头。</li><li>中间不能有空格，可以使用下划线 _。</li><li>不能使用标点符号。</li><li>不能使用bash里的关键字（可用help命令查看保留关键字）。</li></ol><p>shell使用变量时，只需要在变量前加上一个符号<code>$var</code>，或者是 <code>$&#123;var&#125;</code>。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var=<span class="string">&quot;hello&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$var</span></span><br></pre></td></tr></table></figure><p>执行结果:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ bash test.sh</span><br><span class="line">hello</span><br></pre></td></tr></table></figure><p>使用 readonly 命令可以将变量定义为只读变量，只读变量的值不能被改变.</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">cat</span> test.sh</span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line">var=<span class="string">&quot;hello&quot;</span></span><br><span class="line"><span class="built_in">readonly</span> var</span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$var</span></span><br><span class="line">var=<span class="string">&quot;world&quot;</span></span><br></pre></td></tr></table></figure><p>执行结果：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ bash test.sh</span><br><span class="line">hello</span><br><span class="line">test.sh: 行 7: var：只读变量</span><br></pre></td></tr></table></figure><p>使用unset命令可以删除变量:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">unset</span> variable_name</span><br></pre></td></tr></table></figure><blockquote><p>对变量赋空值时，建议使用unset</p></blockquote><h3 id="变量类型">变量类型</h3><p>运行shell时，会同时存在三种变量：</p><ol><li>局部变量 局部变量在脚本或命令中定义，仅在当前shell实例中有效，其他shell启动的程序不能访问局部变量。</li><li>环境变量 所有的程序，包括shell启动的程序，都能访问环境变量，有些程序需要环境变量来保证其正常运行。必要的时候shell脚本也可以定义环境变量。</li><li>shell变量 shell变量是由shell程序设置的特殊变量。shell变量中有一部分是环境变量，有一部分是局部变量，这些变量保证了shell的正常运行</li></ol><h3 id="Shell-字符串">Shell 字符串</h3><p>字符串是shell编程中最常用最有用的数据类型（除了数字和字符串，也没啥其它类型好用了），字符串可以用单引号，也可以用双引号，也可以不用引号。</p><p><strong>单引号</strong></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">str=<span class="string">&#x27;this is a string&#x27;</span></span><br></pre></td></tr></table></figure><p>单引号字符串的限制：<br>* 单引号里的任何字符都会原样输出，单引号字符串中的变量是无效的；<br>* 单引号字串中不能出现单独一个的单引号（对单引号使用转义符后也不行），但可成对出现，作为字符串拼接使用。</p><p><strong>双引号</strong></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">your_name=<span class="string">&quot;victor&quot;</span></span><br><span class="line">str=<span class="string">&quot;Hello, I know you are \&quot;<span class="variable">$your_name</span>\&quot;! \n&quot;</span></span><br></pre></td></tr></table></figure><p>双引号的优点：</p><ul><li>双引号里可以有变量</li><li>双引号里可以出现转义字符</li></ul><blockquote><p>实际使用中，字符串最好使用引号</p></blockquote><p><strong>拼接字符串</strong></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">your_name=<span class="string">&quot;victor&quot;</span></span><br><span class="line"><span class="comment"># 使用双引号拼接</span></span><br><span class="line">greeting=<span class="string">&quot;hello, &quot;</span><span class="variable">$your_name</span><span class="string">&quot; !&quot;</span></span><br><span class="line">greeting_1=<span class="string">&quot;hello, <span class="variable">$&#123;your_name&#125;</span> !&quot;</span></span><br><span class="line"><span class="comment"># 使用单引号拼接</span></span><br><span class="line">greeting_2=<span class="string">&#x27;hello, &#x27;</span><span class="variable">$your_name</span><span class="string">&#x27; !&#x27;</span></span><br></pre></td></tr></table></figure><p><strong>获取字符串长度</strong></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">string=<span class="string">&quot;abcd&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;#string&#125;</span>   <span class="comment"># 输出 4</span></span><br><span class="line"><span class="comment"># 变量为数组时，$&#123;#string&#125; 等价于 $&#123;#string[0]&#125;:</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;#string[0]&#125;</span>   <span class="comment"># 输出 4</span></span><br></pre></td></tr></table></figure><p><strong>提取子字符串</strong></p><p>从字符串第 2 个字符开始截取 4 个字符</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">string=<span class="string">&quot;abcdefg&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;string:1:4&#125;</span> <span class="comment"># 输出 bcde</span></span><br></pre></td></tr></table></figure><p><strong>查找子字符串</strong></p><p>查找字符 i 或 o 的位置(哪个字母先出现就计算哪个)</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">string=<span class="string">&quot;hello world , i am victor&quot;</span></span><br><span class="line"><span class="built_in">echo</span> `<span class="built_in">expr</span> index <span class="string">&quot;<span class="variable">$string</span>&quot;</span> io`  <span class="comment"># 输出 5</span></span><br></pre></td></tr></table></figure><h3 id="shell-数组">shell 数组</h3><p>bash支持一维数组（不支持多维数组），并且没有限定数组的大小。类似于 C 语言，数组元素的下标由 0 开始编号。获取数组中的元素要利用下标，下标可以是整数或算术表达式，其值应大于或等于 0。</p><p>定义数组<br>在 Shell 中，用括号来表示数组，数组元素用&quot;空格&quot;符号分割开。定义数组的一般形式为：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">array_name=(value0 value1 value2 value3)</span><br><span class="line"><span class="comment"># 或者</span></span><br><span class="line">array_name=(</span><br><span class="line">  value0</span><br><span class="line">  value1</span><br><span class="line">  value2</span><br><span class="line">  value3</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>还可以单独定义数组的各个分量：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">array_name[0]=value0</span><br><span class="line">array_name[1]=value1</span><br><span class="line">array_name[n]=valuen</span><br></pre></td></tr></table></figure><blockquote><p>注意，shell的数组定义,可以使用不联系的下标。</p></blockquote><p><strong>读取数组</strong></p><p>读取数组元素的格式是 <code>$&#123;数组名[下标]&#125;</code> ,例如 :</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">valuen=<span class="variable">$&#123;array[n]&#125;</span></span><br></pre></td></tr></table></figure><p>使用<code>@</code>符号可以获取数组中的所有元素，例如:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;array[@]&#125;</span></span><br><span class="line"><span class="comment"># 赋值</span></span><br><span class="line">array_2=(<span class="string">&quot;<span class="variable">$&#123;array[@]&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><p><strong>获取数组长度</strong></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 取得数组元素的个数</span></span><br><span class="line">length=<span class="variable">$&#123;#array_name[@]&#125;</span></span><br><span class="line"><span class="comment"># 或者</span></span><br><span class="line">length=<span class="variable">$&#123;#array_name[*]&#125;</span></span><br><span class="line"><span class="comment"># 取得数组单个元素的长度</span></span><br><span class="line">lengthn=<span class="variable">$&#123;#array_name[n]&#125;</span></span><br></pre></td></tr></table></figure><h2 id="参数传递">参数传递</h2><p>我们可以在执行 Shell 脚本时，向脚本传递参数，脚本内获取参数的格式为：$n。n 代表一个数字，1 为执行脚本的第一个参数，2 为执行脚本的第二个参数。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&quot;Shell 传递参数实例！&quot;</span>;</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;执行的文件名：<span class="variable">$0</span>&quot;</span>;</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;第一个参数为：<span class="variable">$1</span>&quot;</span>;</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;第二个参数为：<span class="variable">$2</span>&quot;</span>;</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;第三个参数为：<span class="variable">$3</span>&quot;</span>;</span><br></pre></td></tr></table></figure><table><thead><tr><th style="text-align:left">参数</th><th style="text-align:left">说明</th></tr></thead><tbody><tr><td style="text-align:left"><code>$#</code></td><td style="text-align:left">传递到脚本的参数个数</td></tr><tr><td style="text-align:left"><code>$*</code></td><td style="text-align:left">以一个单字符串显示所有向脚本传递的参数。如&quot;$*“用「”」括起来的情况、以&quot;$1 $2 … $n&quot;的形式输出所有参数。</td></tr><tr><td style="text-align:left"><code>$$</code></td><td style="text-align:left">脚本运行的当前进程ID号</td></tr><tr><td style="text-align:left"><code>$!</code></td><td style="text-align:left">后台运行的最后一个进程的ID号</td></tr><tr><td style="text-align:left"><code>$@</code></td><td style="text-align:left">与<code>$*</code>相同，但是使用时加引号，并在引号中返回每个参数。如&quot;$@“用「”」括起来的情况、以&quot;$1&quot; “<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mi mathvariant="normal">&quot;</mi><mo>…</mo><mi mathvariant="normal">&quot;</mi></mrow><annotation encoding="application/x-tex">2&quot; … &quot;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.6944em"></span><span class="mord">2&quot;</span><span class="mspace" style="margin-right:.1667em"></span><span class="minner">…</span><span class="mspace" style="margin-right:.1667em"></span><span class="mord">&quot;</span></span></span></span>n” 的形式输出所有参数。</td></tr><tr><td style="text-align:left"><code>$-</code></td><td style="text-align:left">显示Shell使用的当前选项，与set命令功能相同。</td></tr><tr><td style="text-align:left"><code>$?</code></td><td style="text-align:left">显示最后命令的退出状态。0表示没有错误，其他任何值表明有错误。</td></tr></tbody></table><h2 id="字符串值">字符串值</h2><p>定义，获取</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$&#123;var&#125;</span>                          <span class="comment">#  变量var的值, 与$var相同</span></span><br><span class="line"><span class="variable">$&#123;var-DEFAULT&#125;</span>           <span class="comment"># 如果var没有被声明, 那么就以$DEFAULT作为其值 *</span></span><br><span class="line"><span class="variable">$&#123;var:-DEFAULT&#125;</span>          <span class="comment"># 如果var没有被声明, 或者其值为空, 那么就以$DEFAULT作为其值 *</span></span><br><span class="line"><span class="variable">$&#123;var=DEFAULT&#125;</span>           <span class="comment">#  如果var没有被声明, 那么就以$DEFAULT作为其值 *</span></span><br><span class="line"><span class="variable">$&#123;var:=DEFAULT&#125;</span>          <span class="comment">#  如果var没有被声明, 或者其值为空, 那么就以$DEFAULT作为其值 *</span></span><br><span class="line"><span class="variable">$&#123;var+OTHER&#125;</span>              <span class="comment">#  如果var声明了, 那么其值就是$OTHER, 否则就为null字符串</span></span><br><span class="line"><span class="variable">$&#123;var:+OTHER&#125;</span>             <span class="comment"># 如果var被设置了, 那么其值就是$OTHER, 否则就为null字符串</span></span><br><span class="line"><span class="variable">$&#123;var?ERR_MSG&#125;</span>          <span class="comment"># 如果var没被声明, 那么就打印$ERR_MSG *</span></span><br><span class="line"><span class="variable">$&#123;var:?ERR_MSG&#125;</span>         <span class="comment"># 如果var没被设置, 那么就打印$ERR_MSG *</span></span><br><span class="line"><span class="variable">$&#123;!varprefix*&#125;</span>               <span class="comment"># 匹配之前所有以varprefix开头进行声明的变量</span></span><br><span class="line"><span class="variable">$&#123;!varprefix@&#125;</span>              <span class="comment"># 匹配之前所有以varprefix开头进行声明的变量</span></span><br></pre></td></tr></table></figure><p>举个例子:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">hello1=1</span><br><span class="line">hello2=2</span><br><span class="line">hello3=3</span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;!hello*&#125;</span> </span><br><span class="line"><span class="comment"># hello1 hello2 hello3</span></span><br></pre></td></tr></table></figure><p>字符串操作（长度，读取，替换 )</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$&#123;#string&#125;</span>                                         <span class="comment"># $string的长度 </span></span><br><span class="line"><span class="variable">$&#123;string:position&#125;</span>                               <span class="comment"># 在$string中, 从位置$position开始提取子串</span></span><br><span class="line"><span class="variable">$&#123;string:position:length&#125;</span>                     <span class="comment"># 在$string中, 从位置$position开始提取长度为$length的子串     </span></span><br><span class="line"><span class="variable">$&#123;string#substring&#125;</span>                            <span class="comment"># 从变量$string的开头, 删除最短匹配$substring的子串</span></span><br><span class="line"><span class="variable">$&#123;string##substring&#125;</span>                          <span class="comment"># 从变量$string的开头, 删除最长匹配$substring的子串</span></span><br><span class="line"><span class="variable">$&#123;string%substring&#125;</span>                           <span class="comment"># 从变量$string的结尾, 删除最短匹配$substring的子串</span></span><br><span class="line"><span class="variable">$&#123;string%%substring&#125;</span>                        <span class="comment"># 从变量$string的结尾, 删除最长匹配$substring的子串   </span></span><br><span class="line"><span class="variable">$&#123;string/substring/replacement&#125;</span>          <span class="comment"># 使用$replacement, 来代替第一个匹配的$substring</span></span><br><span class="line"><span class="variable">$&#123;string//substring/replacement&#125;</span>        <span class="comment"># 使用$replacement, 代替所有匹配的$substring</span></span><br><span class="line"><span class="variable">$&#123;string/#substring/replacement&#125;</span>        <span class="comment"># 如果$string的前缀匹配$substring, 那么就用$replacement来代替匹配到的$substring</span></span><br><span class="line"><span class="variable">$&#123;string/%substring/replacement&#125;</span>       <span class="comment"># 如果$string的后缀匹配$substring, 那么就用$replacement来代替匹配到的$substring</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 注意 $substring 是一个正则表达式。</span></span><br></pre></td></tr></table></figure><p>举个例子:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 文件类型</span></span><br><span class="line">fileType=<span class="string">&quot;<span class="variable">$&#123;filename##*.&#125;</span>&quot;</span></span><br><span class="line"><span class="comment"># 小写文件类型</span></span><br><span class="line">low=$(<span class="built_in">echo</span> <span class="variable">$fileType</span> | <span class="built_in">tr</span> <span class="string">&#x27;[A-Z]&#x27;</span> <span class="string">&#x27;[a-z]&#x27;</span>)</span><br><span class="line"><span class="comment"># 文件名</span></span><br><span class="line">name=<span class="string">&quot;<span class="variable">$&#123;filename%.*&#125;</span>&quot;</span></span><br></pre></td></tr></table></figure><blockquote><p>在shell中，通过awk,sed,expr 等都可以实现，字符串上述操作.调用外部命令处理，与内置操作符性能相差非常大。在shell编程中，尽量用内置操作符或者函数完成。</p></blockquote><h2 id="shell-基本运算符">shell 基本运算符</h2><p>Shell 和其他编程语言一样，支持多种运算符，包括：</p><ul><li>算数运算符</li><li>关系运算符</li><li>布尔运算符</li><li>字符串运算符</li><li>文件测试运算符</li></ul><blockquote><p>原生bash不支持简单的数学运算，但是可以通过其他命令来实现，例如 awk 和 expr，expr 最常用。expr 是一款表达式计算工具，使用它能完成表达式的求值操作。</p></blockquote><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> `<span class="built_in">expr</span> 2+2` <span class="comment"># 输出 2+2</span></span><br><span class="line"><span class="built_in">echo</span> `<span class="built_in">expr</span> 2 + 2` <span class="comment"># 输出4</span></span><br></pre></td></tr></table></figure><blockquote><p>“``表达式” 有执行内部表达式并返回值的功能。也可以写作$(表达式)</p></blockquote><p>使用 expr时 表达式和运算符之间要有空格。</p><h3 id="算术运算符">算术运算符</h3><p>假定变量 a 为 10，变量 b 为 20：</p><table><thead><tr><th style="text-align:left">运算符</th><th style="text-align:left">说明</th><th style="text-align:left">举例</th></tr></thead><tbody><tr><td style="text-align:left"><code>+</code></td><td style="text-align:left">加法</td><td style="text-align:left"><code>expr $a + $b</code> 结果为 30</td></tr><tr><td style="text-align:left"><code>-</code></td><td style="text-align:left">减法</td><td style="text-align:left"><code>expr $a - $b</code> 结果为 -10</td></tr><tr><td style="text-align:left"><code>*</code></td><td style="text-align:left">乘法</td><td style="text-align:left"><code>expr $a \* $b</code> 结果为 200</td></tr><tr><td style="text-align:left"><code>/</code></td><td style="text-align:left">除法</td><td style="text-align:left"><code>expr $b / $a</code> 结果为 2</td></tr><tr><td style="text-align:left"><code>%</code></td><td style="text-align:left">取余</td><td style="text-align:left"><code>expr $b % $a</code> 结果为 0</td></tr><tr><td style="text-align:left"><code>=</code></td><td style="text-align:left">赋值</td><td style="text-align:left">a=$b 把变量 b 的值赋给 a</td></tr><tr><td style="text-align:left"><code>==</code></td><td style="text-align:left">相等</td><td style="text-align:left">用于比较两个数字，相同则返回 true。	<code>[ $a == $b ]</code> 返回 false</td></tr><tr><td style="text-align:left"><code>!=</code></td><td style="text-align:left">不相等</td><td style="text-align:left">用于比较两个数字，不相同则返回 true。	<code>[ $a != $b ]</code> 返回 true</td></tr></tbody></table><blockquote><p>注意：条件表达式要放在方括号之间，并且要有空格，例如: <code>[$a==$b]</code> 是错误的，必须写成 <code>[ $a == $b ]</code>。</p></blockquote><blockquote><p>乘号(*)前边必须加反斜杠<code>\</code>才能实现乘法运算；有的版本的bash shell 的 expr 语法是：$((表达式))，不需要转义<code>*</code></p></blockquote><h3 id="关系运算符">关系运算符</h3><p>关系运算符只支持数字，不支持字符串，除非字符串的值是数字。下表列出了常用的关系运算符，假定变量 a 为 10，变量 b 为 20。</p><table><thead><tr><th style="text-align:left">运算符</th><th style="text-align:left">说明</th><th style="text-align:left">举例</th></tr></thead><tbody><tr><td style="text-align:left"><code>-eq</code></td><td style="text-align:left">检测两个数是否相等，相等返回 true</td><td style="text-align:left"><code>[ $a -eq $b ]</code> 返回 false</td></tr><tr><td style="text-align:left"><code>-ne</code></td><td style="text-align:left">检测两个数是否不相等，不相等返回 true</td><td style="text-align:left"><code>[ $a -ne $b ]</code> 返回 true</td></tr><tr><td style="text-align:left"><code>-gt</code></td><td style="text-align:left">检测左边的数是否大于右边的，如果是，则返回 true</td><td style="text-align:left"><code>[ $a -gt $b ]</code> 返回 false</td></tr><tr><td style="text-align:left"><code>-lt</code></td><td style="text-align:left">检测左边的数是否小于右边的，如果是，则返回 true</td><td style="text-align:left"><code>[ $a -lt $b ]</code> 返回 true</td></tr><tr><td style="text-align:left"><code>-ge</code></td><td style="text-align:left">检测左边的数是否大于等于右边的，如果是，则返回 true</td><td style="text-align:left"><code>[ $a -ge $b ]</code> 返回 false</td></tr><tr><td style="text-align:left"><code>-le</code></td><td style="text-align:left">检测左边的数是否小于等于右边的，如果是，则返回 true</td><td style="text-align:left"><code>[ $a -le $b ]</code> 返回 true</td></tr></tbody></table><h3 id="布尔运算符">布尔运算符</h3><p>假定变量 a 为 10，变量 b 为 20</p><table><thead><tr><th style="text-align:left">运算符</th><th style="text-align:left">说明</th><th style="text-align:left">举例</th></tr></thead><tbody><tr><td style="text-align:left"><code>!</code></td><td style="text-align:left">非运算，表达式为 true 则返回 false，否则返回 true</td><td style="text-align:left"><code>[ ! false ]</code> 返回 true</td></tr><tr><td style="text-align:left"><code>-o</code></td><td style="text-align:left">或运算，有一个表达式为 true 则返回 true</td><td style="text-align:left"><code>[ $a -lt 20 -o $b -gt 100 ]</code> 返回 true</td></tr><tr><td style="text-align:left"><code>-a</code></td><td style="text-align:left">与运算，两个表达式都为 true 才返回 true</td><td style="text-align:left"><code>[ $a -lt 20 -a $b -gt 100 ]</code> 返回 false</td></tr></tbody></table><h3 id="逻辑运算符">逻辑运算符</h3><p>假定变量 a 为 10，变量 b 为 20:</p><table><thead><tr><th style="text-align:left">运算符</th><th style="text-align:left">说明</th><th style="text-align:left">举例</th></tr></thead><tbody><tr><td style="text-align:left">&amp;&amp;</td><td style="text-align:left">逻辑的 AND</td><td style="text-align:left">[[ $a -lt 100 &amp;&amp; $b -gt 100 ]] 返回 false</td></tr><tr><td style="text-align:left">||</td><td style="text-align:left">逻辑的 OR</td><td style="text-align:left">[[ $a -lt 100 || $b -gt 100 ]] 返回 true</td></tr></tbody></table><h3 id="字符串运算符">字符串运算符</h3><p>假定变量 a 为 10，变量 b 为 20:</p><table><thead><tr><th style="text-align:left">运算符</th><th style="text-align:left">说明</th><th style="text-align:left">举例</th></tr></thead><tbody><tr><td style="text-align:left"><code>=</code></td><td style="text-align:left">检测两个字符串是否相等，相等返回 true。</td><td style="text-align:left"><code>[ $a = $b ]</code> 返回 false。</td></tr><tr><td style="text-align:left"><code>!=</code></td><td style="text-align:left">检测两个字符串是否不相等，不相等返回 true。</td><td style="text-align:left">`[ $a != $b ] 返回 true。</td></tr><tr><td style="text-align:left"><code>-z</code></td><td style="text-align:left">检测字符串长度是否为0，为0返回 true。</td><td style="text-align:left"><code>[ -z $a ]</code> 返回 false。</td></tr><tr><td style="text-align:left"><code>-n</code></td><td style="text-align:left">检测字符串长度是否不为 0，不为 0 返回 true。</td><td style="text-align:left"><code>[ -n &quot;$a&quot; ]</code> 返回 true。</td></tr><tr><td style="text-align:left"><code>$</code></td><td style="text-align:left">检测字符串是否为空，不为空返回 true。</td><td style="text-align:left"><code>[ $a ]</code> 返回 true。</td></tr></tbody></table><p>比较字符串相等的技巧:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> [ <span class="string">&quot;<span class="variable">$test</span>&quot;</span>x = <span class="string">&quot;test&quot;</span>x ]; <span class="keyword">then</span></span><br></pre></td></tr></table></figure><p>注意到<code>&quot;$test&quot;x</code>最后的x，这是特意安排的，因为当$test为空的时候，上面的表达式就变成了x = testx，显然是不相等的。而如果没有这个x，表达式就会报错：<code>[: =: unary operator expected</code></p><h3 id="文件测试运算符">文件测试运算符</h3><p>文件测试运算符用于检测 Unix 文件的各种属性。</p><table><thead><tr><th style="text-align:left">操作符</th><th style="text-align:left">说明</th><th style="text-align:left">举例</th></tr></thead><tbody><tr><td style="text-align:left"><code>-b file</code></td><td style="text-align:left">检测文件是否是块设备文件，如果是，则返回 true。</td><td style="text-align:left"><code>[ -b $file ]</code> 返回 false。</td></tr><tr><td style="text-align:left"><code>-c file</code></td><td style="text-align:left">检测文件是否是字符设备文件，如果是，则返回 true。</td><td style="text-align:left"><code>[ -c $file ]</code> 返回 false。</td></tr><tr><td style="text-align:left"><code>-d file</code></td><td style="text-align:left">检测文件是否是目录，如果是，则返回 true。</td><td style="text-align:left"><code>[ -d $file ]</code> 返回 false。</td></tr><tr><td style="text-align:left"><code>-f file</code></td><td style="text-align:left">检测文件是否是普通文件（既不是目录，也不是设备文件），如果是，则返回 true。</td><td style="text-align:left"><code>[ -f $file ]</code> 返回 true。</td></tr><tr><td style="text-align:left"><code>-g file</code></td><td style="text-align:left">检测文件是否设置了 SGID 位，如果是，则返回 true。</td><td style="text-align:left"><code>[ -g $file ]</code> 返回 false。</td></tr><tr><td style="text-align:left"><code>-k file</code></td><td style="text-align:left">检测文件是否设置了粘着位(Sticky Bit)，如果是，则返回 true。</td><td style="text-align:left"><code>[ -k $file ]</code> 返回 false。</td></tr><tr><td style="text-align:left"><code>-p file</code></td><td style="text-align:left">检测文件是否是有名管道，如果是，则返回 true。</td><td style="text-align:left"><code>[ -p $file ]</code> 返回 false。</td></tr><tr><td style="text-align:left"><code>-u file</code></td><td style="text-align:left">检测文件是否设置了 SUID 位，如果是，则返回 true。</td><td style="text-align:left"><code>[ -u $file ]</code> 返回 false。</td></tr><tr><td style="text-align:left"><code>-r file</code></td><td style="text-align:left">检测文件是否可读，如果是，则返回 true。</td><td style="text-align:left"><code>[ -r $file ]</code> 返回 true。</td></tr><tr><td style="text-align:left"><code>-w file</code></td><td style="text-align:left">检测文件是否可写，如果是，则返回 true。</td><td style="text-align:left"><code>[ -w $file ]</code> 返回 true。</td></tr><tr><td style="text-align:left"><code>-x file</code></td><td style="text-align:left">检测文件是否可执行，如果是，则返回 true。</td><td style="text-align:left"><code>[ -x $file ]</code> 返回 true。</td></tr><tr><td style="text-align:left"><code>-s file</code></td><td style="text-align:left">检测文件是否为空（文件大小是否大于0），不为空返回 true。</td><td style="text-align:left"><code>[ -s $file ]</code> 返回 true。</td></tr><tr><td style="text-align:left"><code>-e file</code></td><td style="text-align:left">检测文件（包括目录）是否存在，如果是，则返回 true。</td><td style="text-align:left"><code>[ -e $file ]</code> 返回 true。</td></tr></tbody></table><ul><li>-S: 判断某文件是否 socket。</li><li>-L: 检测文件是否存在并且是一个符号链接。</li></ul><h2 id="控制结构">控制结构</h2><h3 id="if-else">if-else</h3><p>if 语句语法格式：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> condition1</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">    command1</span><br><span class="line"><span class="keyword">elif</span> condition2 </span><br><span class="line"><span class="keyword">then</span> </span><br><span class="line">    command2</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    commandN</span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure><p>写成一行（适用于终端命令提示符）：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> [ $(ps -ef | grep -c <span class="string">&quot;ssh&quot;</span>) -gt 1 ]; <span class="keyword">then</span> <span class="built_in">echo</span> <span class="string">&quot;true&quot;</span>; <span class="keyword">fi</span></span><br></pre></td></tr></table></figure><h3 id="for">for</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> var <span class="keyword">in</span> item1 item2 ... itemN</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">    command1</span><br><span class="line">    command2</span><br><span class="line">    ...</span><br><span class="line">    commandN</span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure><p>遍历目录</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 获取目录下的所有子项</span></span><br><span class="line">files=$(<span class="built_in">ls</span> <span class="variable">$path</span>)</span><br><span class="line"><span class="keyword">for</span> filename <span class="keyword">in</span> <span class="variable">$files</span></span><br><span class="line"><span class="keyword">do</span></span><br><span class="line"> <span class="built_in">echo</span> <span class="string">&quot;handle file: <span class="variable">$filename</span>&quot;</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure><h3 id="while-语句">while 语句</h3><p>while 循环用于不断执行一系列命令，也用于从输入文件中读取数据。其语法格式为：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> condition</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">    <span class="built_in">command</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure><h3 id="无限循环">无限循环</h3><p>无限循环语法格式：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> :</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">    <span class="built_in">command</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure><p>或者</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> <span class="literal">true</span></span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">    <span class="built_in">command</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure><p>或者</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (( ; ; ))</span><br></pre></td></tr></table></figure><h3 id="until-循环">until 循环</h3><p>until 循环执行一系列命令直至条件为 true 时停止。</p><p>until 循环与 while 循环在处理方式上刚好相反。</p><p>一般 while 循环优于 until 循环，但在某些时候—也只是极少数情况下，until 循环更加有用。</p><p>until 语法格式:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">until</span> condition</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">    <span class="built_in">command</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure><h3 id="case-…-esac">case … esac</h3><p>case … esac 为多选择语句，与其他语言中的 switch … case 语句类似，是一种多分支选择结构，每个 case 分支用右圆括号开始，用两个分号 ;; 表示 break，即执行结束，跳出整个 case … esac 语句，esac（就是 case 反过来）作为结束标记。可以用 case 语句匹配一个值与一个模式，如果匹配成功，执行相匹配的命令。</p><p>case … esac 语法格式如下：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">case</span> 值 <span class="keyword">in</span></span><br><span class="line">模式1)</span><br><span class="line">    command1</span><br><span class="line">    command2</span><br><span class="line">    ...</span><br><span class="line">    commandN</span><br><span class="line">    ;;</span><br><span class="line">模式2)</span><br><span class="line">    command1</span><br><span class="line">    command2</span><br><span class="line">    ...</span><br><span class="line">    commandN</span><br><span class="line">    ;;</span><br><span class="line"><span class="keyword">esac</span></span><br></pre></td></tr></table></figure><p>case 工作方式如上所示，取值后面必须为单词 in，每一模式必须以右括号结束。取值可以为变量或常数，匹配发现取值符合某一模式后，其间所有命令开始执行直至 ;;。</p><p>取值将检测匹配的每一个模式。一旦模式匹配，则执行完匹配模式相应命令后不再继续其他模式。如果无一匹配模式，使用星号 * 捕获该值，再执行后面的命令。</p><p>shell demo:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;输入 1 到 4 之间的数字:&#x27;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;你输入的数字为:&#x27;</span></span><br><span class="line"><span class="built_in">read</span> aNum</span><br><span class="line"><span class="keyword">case</span> <span class="variable">$aNum</span> <span class="keyword">in</span></span><br><span class="line">    1)  <span class="built_in">echo</span> <span class="string">&#x27;你选择了 1&#x27;</span></span><br><span class="line">    ;;</span><br><span class="line">    2)  <span class="built_in">echo</span> <span class="string">&#x27;你选择了 2&#x27;</span></span><br><span class="line">    ;;</span><br><span class="line">    3)  <span class="built_in">echo</span> <span class="string">&#x27;你选择了 3&#x27;</span></span><br><span class="line">    ;;</span><br><span class="line">    4)  <span class="built_in">echo</span> <span class="string">&#x27;你选择了 4&#x27;</span></span><br><span class="line">    ;;</span><br><span class="line">    *)  <span class="built_in">echo</span> <span class="string">&#x27;你没有输入 1 到 4 之间的数字&#x27;</span></span><br><span class="line">    ;;</span><br><span class="line"><span class="keyword">esac</span></span><br></pre></td></tr></table></figure><h3 id="跳出循环">跳出循环</h3><p>在循环过程中，有时候需要在未达到循环结束条件时强制跳出循环，Shell使用两个命令来实现该功能：break和continue。</p><p>break命令允许跳出所有循环（终止执行后面的所有循环）。下面的例子中，脚本进入死循环直至用户输入数字大于5。要跳出这个循环，返回到shell提示符下，需要使用break命令。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="keyword">while</span> :</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">    <span class="built_in">echo</span> -n <span class="string">&quot;输入 1 到 5 之间的数字:&quot;</span></span><br><span class="line">    <span class="built_in">read</span> aNum</span><br><span class="line">    <span class="keyword">case</span> <span class="variable">$aNum</span> <span class="keyword">in</span></span><br><span class="line">        1|2|3|4|5) <span class="built_in">echo</span> <span class="string">&quot;你输入的数字为 <span class="variable">$aNum</span>!&quot;</span></span><br><span class="line">        ;;</span><br><span class="line">        *) <span class="built_in">echo</span> <span class="string">&quot;你输入的数字不是 1 到 5 之间的! 游戏结束&quot;</span></span><br><span class="line">            <span class="built_in">break</span></span><br><span class="line">        ;;</span><br><span class="line">    <span class="keyword">esac</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure><p>continue命令与break命令类似，只有一点差别，它不会跳出所有循环，仅仅跳出当前循环。</p><p>对上面的例子进行修改：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="keyword">while</span> :</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">    <span class="built_in">echo</span> -n <span class="string">&quot;输入 1 到 5 之间的数字: &quot;</span></span><br><span class="line">    <span class="built_in">read</span> aNum</span><br><span class="line">    <span class="keyword">case</span> <span class="variable">$aNum</span> <span class="keyword">in</span></span><br><span class="line">        1|2|3|4|5) <span class="built_in">echo</span> <span class="string">&quot;你输入的数字为 <span class="variable">$aNum</span>!&quot;</span></span><br><span class="line">        ;;</span><br><span class="line">        *) <span class="built_in">echo</span> <span class="string">&quot;你输入的数字不是 1 到 5 之间的!&quot;</span></span><br><span class="line">            <span class="built_in">continue</span></span><br><span class="line">            <span class="built_in">echo</span> <span class="string">&quot;游戏结束&quot;</span></span><br><span class="line">        ;;</span><br><span class="line">    <span class="keyword">esac</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="comment"># 运行代码发现，当输入大于5的数字时，该例中的循环不会结束，语句 echo &quot;游戏结束&quot; 永远不会被执行。</span></span><br></pre></td></tr></table></figure><h2 id="shell-函数">shell 函数</h2><p>shell中函数的定义格式如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[ function ] funname [()]</span><br><span class="line">&#123;</span><br><span class="line">    action;</span><br><span class="line">    [return int;]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p><code>[ ]</code> 包围的表示可选;</p></blockquote><h3 id="返回值处理">返回值处理:</h3><ol><li>echo 字符串</li></ol><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">lockdir=<span class="string">&quot;somedir&quot;</span></span><br><span class="line"><span class="function"><span class="title">testlock</span></span>()&#123;</span><br><span class="line">    retval=<span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">mkdir</span> <span class="string">&quot;<span class="variable">$lockdir</span>&quot;</span></span><br><span class="line">    <span class="keyword">then</span> <span class="comment"># Directory did not exist, but it was created successfully</span></span><br><span class="line">         <span class="built_in">echo</span> &gt;&amp;2 <span class="string">&quot;successfully acquired lock: <span class="variable">$lockdir</span>&quot;</span></span><br><span class="line">         retval=<span class="string">&quot;true&quot;</span></span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">         <span class="built_in">echo</span> &gt;&amp;2 <span class="string">&quot;cannot acquire lock, giving up on <span class="variable">$lockdir</span>&quot;</span></span><br><span class="line">         retval=<span class="string">&quot;false&quot;</span></span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$retval</span>&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">retval=$( testlock )</span><br><span class="line"><span class="keyword">if</span> [ <span class="string">&quot;<span class="variable">$retval</span>&quot;</span> == <span class="string">&quot;true&quot;</span> ]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">     <span class="built_in">echo</span> <span class="string">&quot;directory not created&quot;</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">     <span class="built_in">echo</span> <span class="string">&quot;directory already created&quot;</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure><ol start="2"><li>return int 返回退出状态，该状态是数字，而不是字符串</li></ol><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">lockdir=<span class="string">&quot;somedir&quot;</span></span><br><span class="line"><span class="function"><span class="title">testlock</span></span>()&#123;</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">mkdir</span> <span class="string">&quot;<span class="variable">$lockdir</span>&quot;</span></span><br><span class="line">    <span class="keyword">then</span> <span class="comment"># Directory did not exist, but was created successfully</span></span><br><span class="line">         <span class="built_in">echo</span> &gt;&amp;2 <span class="string">&quot;successfully acquired lock: <span class="variable">$lockdir</span>&quot;</span></span><br><span class="line">         retval=0</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">         <span class="built_in">echo</span> &gt;&amp;2 <span class="string">&quot;cannot acquire lock, giving up on <span class="variable">$lockdir</span>&quot;</span></span><br><span class="line">         retval=1</span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line">    <span class="built_in">return</span> <span class="string">&quot;<span class="variable">$retval</span>&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">testlock</span><br><span class="line">retval=$?</span><br><span class="line"><span class="keyword">if</span> [ <span class="string">&quot;<span class="variable">$retval</span>&quot;</span> == 0 ]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">     <span class="built_in">echo</span> <span class="string">&quot;directory not created&quot;</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">     <span class="built_in">echo</span> <span class="string">&quot;directory already created&quot;</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure><ol start="3"><li>共享变量</li></ol><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">lockdir=<span class="string">&quot;somedir&quot;</span></span><br><span class="line">retval=-1</span><br><span class="line"><span class="function"><span class="title">testlock</span></span>()&#123;</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">mkdir</span> <span class="string">&quot;<span class="variable">$lockdir</span>&quot;</span></span><br><span class="line">    <span class="keyword">then</span> <span class="comment"># Directory did not exist, but it was created successfully</span></span><br><span class="line">         <span class="built_in">echo</span> &gt;&amp;2 <span class="string">&quot;successfully acquired lock: <span class="variable">$lockdir</span>&quot;</span></span><br><span class="line">         retval=0</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">         <span class="built_in">echo</span> &gt;&amp;2 <span class="string">&quot;cannot acquire lock, giving up on <span class="variable">$lockdir</span>&quot;</span></span><br><span class="line">         retval=1</span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">testlock</span><br><span class="line"><span class="keyword">if</span> [ <span class="string">&quot;<span class="variable">$retval</span>&quot;</span> == 0 ]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">     <span class="built_in">echo</span> <span class="string">&quot;directory not created&quot;</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">     <span class="built_in">echo</span> <span class="string">&quot;directory already created&quot;</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure><p>函数返回值k可以调用该函数后通过 $? 来获得。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">funWithReturn</span></span>()&#123;</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;这个函数会对输入的两个数字进行相加运算...&quot;</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;输入第一个数字: &quot;</span></span><br><span class="line">    <span class="built_in">read</span> aNum</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;输入第二个数字: &quot;</span></span><br><span class="line">    <span class="built_in">read</span> anotherNum</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;两个数字分别为 <span class="variable">$aNum</span> 和 <span class="variable">$anotherNum</span> !&quot;</span></span><br><span class="line">    <span class="built_in">return</span> $((<span class="variable">$aNum</span>+<span class="variable">$anotherNum</span>))</span><br><span class="line">&#125;</span><br><span class="line">funWithReturn</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;输入的两个数字之和为 $? !&quot;</span></span><br></pre></td></tr></table></figure><h3 id="函数参数">函数参数</h3><p>在Shell中，调用函数时可以向其传递参数。在函数体内部，通过 <code>$n</code> 的形式来获取参数的值，例如，<code>$1</code>表示第一个参数，<code>$2</code>表示第二个参数，带参数的函数示例：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">funWithParam</span></span>()&#123;</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;第一个参数为 <span class="variable">$1</span> !&quot;</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;第二个参数为 <span class="variable">$2</span> !&quot;</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;第十个参数为 <span class="variable">$10</span> !&quot;</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;第十个参数为 <span class="variable">$&#123;10&#125;</span> !&quot;</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;第十一个参数为 <span class="variable">$&#123;11&#125;</span> !&quot;</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;参数总数有 <span class="variable">$#</span> 个!&quot;</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;作为一个字符串输出所有参数 $* !&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">funWithParam 1 2 3 4 5 6 7 8 9 34 73</span><br></pre></td></tr></table></figure><table><thead><tr><th style="text-align:left">参数处理</th><th style="text-align:left">说明</th></tr></thead><tbody><tr><td style="text-align:left"><code>$#</code></td><td style="text-align:left">传递到脚本或函数的参数个数</td></tr><tr><td style="text-align:left"><code>$*</code></td><td style="text-align:left">以一个单字符串显示所有向脚本传递的参数</td></tr><tr><td style="text-align:left"><code>$$</code></td><td style="text-align:left">脚本运行的当前进程ID号</td></tr><tr><td style="text-align:left"><code>$!</code></td><td style="text-align:left">后台运行的最后一个进程的ID号</td></tr><tr><td style="text-align:left"><code>$@</code></td><td style="text-align:left">与<code>$*</code>相同，但是使用时加引号，并在引号中返回每个参数。</td></tr><tr><td style="text-align:left"><code>$-</code></td><td style="text-align:left">显示Shell使用的当前选项，与set命令功能相同。</td></tr><tr><td style="text-align:left"><code>$?</code></td><td style="text-align:left">显示最后命令的退出状态。0表示没有错误，其他任何值表明有错误</td></tr></tbody></table><h3 id="import">import</h3><p>Shell 也可以包含外部脚本。这样可以很方便的封装一些公用的代码作为一个独立的文件。Shell 文件包含的语法格式如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">. filename   # 注意点号(.)和文件名中间有一空格</span><br></pre></td></tr></table></figure><p>或</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source filename</span><br></pre></td></tr></table></figure><h3 id="local-变量">local 变量</h3><p>local一般用于局部变量声明，多在在函数内部使用。</p><ol><li>shell脚本中定义的变量是global的，其作用域从被定义的地方开始，到shell结束或被显示删除的地方为止。</li><li>shell函数定义的变量默认是global的，其作用域从“函数被调用时执行变量定义的地方”开始，到shell结束或被显示删除处为止。函数定义的变量可以被显示定义成local的，其作用域局限于函数内。但请注意，函数的参数是local的。</li><li>如果同名，Shell函数定义的local变量会屏蔽脚本定义的global变量。</li></ol><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">text=<span class="string">&#x27;just test!!!&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">Hello</span></span>()&#123;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">local</span> text=<span class="string">&quot;Hello World!!!&quot;</span> <span class="comment">#局部变量</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="variable">$text</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Hello</span><br><span class="line"></span><br><span class="line"><span class="comment"># output: Hello World!!!</span></span><br></pre></td></tr></table></figure><h2 id="管道">管道</h2><p><code>|</code>是Linux管道命令操作符，简称管道符。使用此管道符<code>|</code>可以将两个命令分隔开，左边命令的输出就会作为右边命令的输入，此命令可连续使用，第一个命令的输出会作为第二个命令的输入，第二个命令的输出又会作为第三个命令的输入，依此类推。</p><h3 id="管道返回值">管道返回值</h3><p>BASH SHELL中，通常使用<code>$?</code>来获取上一条命令的返回码。对于管道中的命令，使用$?只能获取管道中最后一条命令的返回码，例如下面的例子中/not/a/valid/filename是一个不存在的文件。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> /not/a/valid/filename|<span class="built_in">cat</span></span><br></pre></td></tr></table></figure><p>第一个cat失败，第二个cat成功，所以<code>$?</code>的值为0。这种情况下，可以使用<code>$PIPESTATUS</code>来获取管道中每个命令的返回码。</p><ol><li>PIPESTATUS 是一个数组，第一条命令的返回码存储在<code>$&#123;PIPESTATUS[0]&#125;</code>，以此类推，上例中执行完管道中所有的命令后，PIPESTATUS数组第一个元素值为1，第二个元素值为0.</li><li>如果前一条命令不是一个管道，而是一个单独的命令，命令的返回码存储为<code>$&#123;PIPESTATUS[0]&#125;</code>，此时<code>$&#123;PIPESTATUS[0]&#125;</code>同<code>$?</code>值相同（事实上，PIPESTATUS最后一个元素的值总是与<code>$?</code>的值相同）</li><li>每执行一条命令，切记PIPESTATUS都会更新其值为上一条命令的返回码，</li></ol><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> /not/a/valid/filename|<span class="built_in">cat</span></span><br><span class="line"><span class="keyword">if</span> [ <span class="variable">$&#123;PIPESTATUS[0]&#125;</span> -ne 0 ]; <span class="keyword">then</span> <span class="built_in">echo</span> <span class="variable">$&#123;PIPESTATUS[@]&#125;</span>; <span class="keyword">fi</span></span><br></pre></td></tr></table></figure><p>上例中执行完管道后，<code>$&#123;PIPESTATUS[0]&#125;</code>值为1，<code>$&#123;PIPESTATUS[1]&#125;</code>值为0。但是上面的脚本执行完成后，输出为0，这是因为if 分支的测试命令值为真，然后<code>PIPESTATUS[0]</code>的值此时被置为0。应当在命令执行完成后立即在同一个测试命令中对所有值进行测试，或者先将$PIPESTATUS数组保存下来，以后再处理。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">tar -cf - ./* | ( <span class="built_in">cd</span> <span class="string">&quot;<span class="variable">$&#123;dir&#125;</span>&quot;</span> &amp;&amp; tar -xf - )</span><br><span class="line"><span class="keyword">if</span> [[ <span class="string">&quot;<span class="variable">$&#123;PIPESTATUS[0]&#125;</span>&quot;</span> -ne 0 || <span class="string">&quot;<span class="variable">$&#123;PIPESTATUS[1]&#125;</span>&quot;</span> -ne 0 ]]; <span class="keyword">then</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">&quot;Unable to tar files to <span class="variable">$&#123;dir&#125;</span>&quot;</span> &gt;&amp;2</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"><span class="comment"># =========== or ==============</span></span><br><span class="line">tar -cf - ./* | ( <span class="built_in">cd</span> <span class="string">&quot;<span class="variable">$&#123;DIR&#125;</span>&quot;</span> &amp;&amp; tar -xf - )</span><br><span class="line">return_codes=(<span class="variable">$&#123;PIPESTATUS[*]&#125;</span>)</span><br><span class="line"><span class="keyword">if</span> [[ <span class="string">&quot;<span class="variable">$&#123;return_codes[0]&#125;</span>&quot;</span> -ne 0 ]]; <span class="keyword">then</span></span><br><span class="line">  do_something</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"><span class="keyword">if</span> [[ <span class="string">&quot;<span class="variable">$&#123;return_codes[1]&#125;</span>&quot;</span> -ne 0 ]]; <span class="keyword">then</span></span><br><span class="line">  do_something_else</span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure><h3 id="xargs">xargs</h3><p>xargs命令的作用，是将标准输入转为命令行参数。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">echo</span> <span class="string">&quot;hello world&quot;</span> | xargs <span class="built_in">echo</span></span><br><span class="line">hello world</span><br></pre></td></tr></table></figure><p>上面的代码将管道左侧的标准输入，转为命令行参数hello world，传给第二个echo命令(xargs后面的命令默认是echo,此处echo可以省略)。</p><p>默认情况下，xargs将换行符和空格作为分隔符，把标准输入分解成一个个命令行参数。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">echo</span> <span class="string">&quot;a b c&quot;</span> | xargs </span><br><span class="line">$ <span class="built_in">echo</span> -e <span class="string">&quot;a\tb\tc&quot;</span> | xargs -d <span class="string">&quot;\t&quot;</span> </span><br></pre></td></tr></table></figure><p>使用xargs命令以后，由于存在转换参数过程，有时需要确认一下到底执行的是什么命令。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># `-p` 参数打印出要执行的命令，询问用户是否要执行。</span></span><br><span class="line"><span class="comment"># 用户输入y以后（大小写皆可），才会真正执行。</span></span><br><span class="line">$ <span class="built_in">echo</span> <span class="string">&#x27;a b c&#x27;</span> | xargs -p </span><br><span class="line">/bin/echo a b c?...</span><br><span class="line"></span><br><span class="line"><span class="comment"># `-t`参数则是打印出最终要执行的命令，然后直接执行，不需要用户确认。</span></span><br><span class="line">$ <span class="built_in">echo</span> <span class="string">&#x27;a b c&#x27;</span> | xargs -t</span><br><span class="line">/bin/echo a b c</span><br><span class="line">a b c</span><br></pre></td></tr></table></figure><p>如果标准输入包含多行，-L参数指定多少行作为一个命令行参数。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$echo</span> -e <span class="string">&quot;a\nb\nc&quot;</span> | xargs -L 1</span><br><span class="line">a</span><br><span class="line">b</span><br><span class="line">c</span><br></pre></td></tr></table></figure><p>-L参数虽然解决了多行的问题，但是有时用户会在同一行输入多项。-n参数指定每次将多少项，作为命令行参数。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">echo</span> &#123;0..9&#125; | xargs -n 2</span><br><span class="line">0 1</span><br><span class="line">2 3</span><br><span class="line">4 5</span><br><span class="line">6 7</span><br><span class="line">8 9</span><br></pre></td></tr></table></figure><p>如果xargs要将命令行参数传给多个命令，可以使用-I参数。-I指定每一项命令行参数的替代字符串。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ find . -name <span class="string">&quot;*.txt&quot;</span> | xargs -I &#123;&#125; <span class="built_in">mv</span> &#123;&#125; &#123;&#125;.bak</span><br></pre></td></tr></table></figure><p>上述命令将查找当前目录下所有扩展名为 .txt 的文件，并将它们作为参数传递给 mv 命令进行重命名，将扩展名改为 <code>.txt.bak</code>。</p><h2 id="shell-输入-输出重定向">shell 输入/输出重定向</h2><p>大多数 UNIX 系统命令从你的终端接受输入并将所产生的输出发送回​​到您的终端。一个命令通常从一个叫标准输入的地方读取输入，默认情况下，这恰好是你的终端。同样，一个命令通常将其输出写入到标准输出，默认情况下，这也是你的终端。</p><table><thead><tr><th style="text-align:left">命令</th><th style="text-align:left">说明</th></tr></thead><tbody><tr><td style="text-align:left"><code>command &gt; file</code></td><td style="text-align:left">将输出重定向到 file。</td></tr><tr><td style="text-align:left"><code>command &lt; file</code></td><td style="text-align:left">将输入重定向到 file。</td></tr><tr><td style="text-align:left"><code>command &gt;&gt; file</code></td><td style="text-align:left">将输出以追加的方式重定向到 file。</td></tr><tr><td style="text-align:left"><code>n &gt; file</code></td><td style="text-align:left">将文件描述符为 n 的文件重定向到 file。</td></tr><tr><td style="text-align:left"><code>n &gt;&gt; file</code></td><td style="text-align:left">将文件描述符为 n 的文件以追加的方式重定向到 file。</td></tr><tr><td style="text-align:left"><code>n &gt;&amp; m</code></td><td style="text-align:left">将输出文件 m 和 n 合并。</td></tr><tr><td style="text-align:left"><code>n &lt;&amp; m</code></td><td style="text-align:left">将输入文件 m 和 n 合并。</td></tr><tr><td style="text-align:left"><code>&lt;&lt; tag</code></td><td style="text-align:left">将开始标记 tag 和结束标记 tag 之间的内容作为输入。</td></tr></tbody></table><p>一般情况下，每个 Unix/Linux 命令运行时都会打开三个文件：</p><ol><li>标准输入文件(stdin)：stdin的文件描述符为0，Unix程序默认从stdin读取数据。</li><li>标准输出文件(stdout)：stdout 的文件描述符为1，Unix程序默认向stdout输出数据。</li><li>标准错误文件(stderr)：stderr的文件描述符为2，Unix程序会向stderr流中写入错误信息。</li></ol><p>默认情况下，command &gt; file 将 stdout 重定向到 file，command &lt; file 将stdin 重定向到 file。</p><p>如果希望 stderr 重定向到 file，可以这样写：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">command</span> 2&gt;file</span><br></pre></td></tr></table></figure><p>如果希望 stderr 追加到 file 文件末尾，可以这样写：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">command</span> 2&gt;&gt;file</span><br></pre></td></tr></table></figure><p>2 表示标准错误文件(stderr)。如果希望将 stdout 和 stderr 合并后重定向到 file，可以这样写：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">command</span> &gt; file 2&gt;&amp;1</span><br></pre></td></tr></table></figure><p>或者</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">command</span> &gt;&gt; file 2&gt;&amp;1</span><br></pre></td></tr></table></figure><p>如果希望对 stdin 和 stdout 都重定向，可以这样写：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">command</span> &lt; file1 &gt;file2</span><br></pre></td></tr></table></figure><h3 id="Here-Document">Here Document</h3><p>Here Document 是 Shell 中的一种特殊的重定向方式，用来将输入重定向到一个交互式 Shell 脚本或程序。</p><p>它的基本的形式如下：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">command</span> &lt;&lt; <span class="string">delimiter</span></span><br><span class="line"><span class="string">    document</span></span><br><span class="line"><span class="string">delimiter</span></span><br></pre></td></tr></table></figure><p>它的作用是将两个 delimiter 之间的内容(document) 作为输入传递给 command。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> &lt;&lt; <span class="string">EOF</span></span><br><span class="line"><span class="string">hello</span></span><br><span class="line"><span class="string">world</span></span><br><span class="line"><span class="string">EOF</span></span><br></pre></td></tr></table></figure><p>默认地，会进行变量替换和命令替换：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">cat</span> &lt;&lt; <span class="string">EOF</span></span><br><span class="line"><span class="string">Working dir $PWD</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line"></span><br><span class="line">Working <span class="built_in">dir</span> /home/user</span><br></pre></td></tr></table></figure><p>可以通过使用引号包裹标识符来禁用。可以使用单引号或双引号：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">cat</span> &lt;&lt; <span class="string">&quot;EOF&quot;</span></span><br><span class="line">Working <span class="built_in">dir</span> <span class="variable">$PWD</span></span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line">Working <span class="built_in">dir</span> <span class="variable">$PWD</span></span><br></pre></td></tr></table></figure><p>如果想在ssh命令中同时使用本地变量和远程变量。那么可以在远程变量前加上<code>\</code>。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">A=3;</span><br><span class="line">ssh host@name &lt;&lt; <span class="string">EOF</span></span><br><span class="line"><span class="string">B=4; </span></span><br><span class="line"><span class="string">echo $A;</span></span><br><span class="line"><span class="string">echo \$B;</span></span><br><span class="line"><span class="string">EOF</span></span><br></pre></td></tr></table></figure><h3 id="dev-null-文件">/dev/null 文件</h3><p>如果希望执行某个命令，但又不希望在屏幕上显示输出结果，那么可以将输出重定向到 /dev/null：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">command</span> &gt; /dev/null</span><br></pre></td></tr></table></figure><p>/dev/null 是一个特殊的文件，写入到它的内容都会被丢弃；如果尝试从该文件读取内容，那么什么也读不到。但是 /dev/null 文件非常有用，将命令的输出重定向到它，会起到&quot;禁止输出&quot;的效果。</p><p>如果希望屏蔽 stdout 和 stderr，可以这样写：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ command &gt; /dev/null 2&gt;&amp;1</span><br></pre></td></tr></table></figure><blockquote><p>注意：0 是标准输入（STDIN），1 是标准输出（STDOUT），2 是标准错误输出（STDERR）。这里的 2 和 &gt; 之间不可以有空格，2&gt; 是一体的时候才表示错误输出。</p></blockquote><h2 id="shell-常用命令">shell 常用命令</h2><h3 id="set">set</h3><p>Linux set命令用于设置shell。set指令能设置所使用shell的执行方式，可依照不同的需求来做设置。set 后面不跟参数时，会显示所有环境变量。</p><p>语法:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">set</span> [+-abCdefhHklmnpPtuvx]</span><br></pre></td></tr></table></figure><p>参数说明：</p><ul><li>-a 　标示已修改的变量，以供输出至环境变量。</li><li>-b 　使被中止的后台程序立刻回报执行状态。</li><li>-C 　转向所产生的文件无法覆盖已存在的文件。</li><li>-d 　Shell预设会用杂凑表记忆使用过的指令，以加速指令的执行。使用-d参数可取消。</li><li>-e 　若指令传回值不等于0，则立即退出shell。</li><li>-f　 取消使用通配符。</li><li>-h 　自动记录函数的所在位置。</li><li>-H Shell 　可利用&quot;!&quot;加&lt;指令编号&gt;的方式来执行history中记录的指令。</li><li>-k 　指令所给的参数都会被视为此指令的环境变量。</li><li>-l 　记录for循环的变量名称。</li><li>-m 　使用监视模式。</li><li>-n 　只读取指令，而不实际执行。</li><li>-p 　启动优先顺序模式。</li><li>-P 　启动-P参数后，执行指令时，会以实际的文件或目录来取代符号连接。</li><li>-t 　执行完随后的指令，即退出shell。</li><li>-u 　当执行时使用到未定义过的变量，则显示错误信息。</li><li>-v 　显示shell所读取的输入值。</li><li>-x 　执行指令后，会先显示该指令及所下的参数。</li><li>-o pipefail 此设置可防止管道中的错误被屏蔽。如果管道中的任何命令失败，则该返回代码将用作整个管道的返回代码。</li><li>+&lt;参数&gt; 　取消某个set曾启动的参数。</li></ul><p>Bash 严格模式: <code>set -euo pipefail</code></p><p>有时，您的脚本需要获取不适用于严格模式的文件。解决办法是：暂时禁用严格模式,然后在下一行重新启用。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">set</span> +u</span><br><span class="line"><span class="built_in">source</span> some/bad/file.env</span><br><span class="line"><span class="built_in">set</span> -u</span><br></pre></td></tr></table></figure><h3 id="echo">echo</h3><p>echo 指令用于字符串的输出。命令格式：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> string</span><br></pre></td></tr></table></figure><ol><li>显示普通字符串:</li></ol><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&quot;It is a test&quot;</span></span><br></pre></td></tr></table></figure><p>这里的双引号完全可以省略，以下命令与上面实例效果一致：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo It is a test</span><br></pre></td></tr></table></figure><ol start="2"><li>显示转义字符</li></ol><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&quot;\&quot;It is a test\&quot;&quot;</span></span><br></pre></td></tr></table></figure><p>结果将是:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;It is a test&quot;</span><br></pre></td></tr></table></figure><ol start="3"><li>显示变量</li></ol><p>read 命令从标准输入中读取一行,并把输入行的每个字段的值指定给 shell 变量</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/sh</span></span><br><span class="line"><span class="built_in">read</span> name </span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$name</span> It is a test&quot;</span></span><br></pre></td></tr></table></figure><ol start="4"><li>显式换行</li></ol><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> -e <span class="string">&quot;OK! \n&quot;</span> <span class="comment"># -e 开启转义</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;It is a test&quot;</span></span><br></pre></td></tr></table></figure><ol start="5"><li>显式不换行</li></ol><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/sh</span></span><br><span class="line"><span class="built_in">echo</span> -e <span class="string">&quot;OK! \c&quot;</span> <span class="comment"># -e 开启转义 \c 不换行</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;It is a test&quot;</span></span><br></pre></td></tr></table></figure><ol start="6"><li>原样输出字符串，不进行转义或取变量(用单引号)</li></ol><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;$name\&quot;&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="printf">printf</h3><p>printf 使用引用文本或空格分隔的参数，外面可以在 printf 中使用格式化字符串，还可以制定字符串的宽度、左右对齐方式等。默认的 printf 不会像 echo 自动添加换行符，我们可以手动添加 \n。printf 命令的语法：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">printf</span>  format-string  [arguments...]</span><br></pre></td></tr></table></figure><ol><li>format-string为双引号，单引号，效果一样，没有引号也可以输出</li><li>格式只指定了一个参数，但多出的参数仍然会按照该格式输出，format-string 被重用</li><li>如果没有 arguments，那么 %s 用NULL代替，%d 用 0 代替</li></ol><p>例子：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">printf</span> <span class="string">&quot;%-10s %-8s %-4s\n&quot;</span> 姓名 性别 体重kg  </span><br><span class="line"><span class="built_in">printf</span> <span class="string">&quot;%-10s %-8s %-4.2f\n&quot;</span> 郭靖 男 66.1234</span><br><span class="line"><span class="built_in">printf</span> <span class="string">&quot;%-10s %-8s %-4.2f\n&quot;</span> 杨过 男 48.6543</span><br><span class="line"><span class="built_in">printf</span> <span class="string">&quot;%-10s %-8s %-4.2f\n&quot;</span> 郭芙 女 47.9876</span><br></pre></td></tr></table></figure><p><code>%s</code> <code>%c</code> <code>%d</code> <code>%f</code> 都是格式替代符，<code>％s</code> 输出一个字符串，<code>％d</code> 整型输出，<code>％c</code> 输出一个字符，<code>％f</code> 输出实数，以小数形式输出。<code>%-10s</code> 指一个宽度为 10 个字符（- 表示左对齐，没有则表示右对齐），任何字符都会被显示在 10 个字符宽的字符内，如果不足则自动以空格填充，超过也会将内容全部显示出来。<code>%-4.2f</code> 指格式化为小数，其中 .2 指保留2位小数。</p><p>printf 的转义序列：</p><table><thead><tr><th style="text-align:left">序列</th><th style="text-align:left">说明</th></tr></thead><tbody><tr><td style="text-align:left"><code>\a</code></td><td style="text-align:left">警告字符，通常为ASCII的BEL字符</td></tr><tr><td style="text-align:left"><code>\b</code></td><td style="text-align:left">后退</td></tr><tr><td style="text-align:left"><code>\c</code></td><td style="text-align:left">抑制（不显示）输出结果中任何结尾的换行字符（只在%b格式指示符控制下的参数字符串中有效），而且，任何留在参数里的字符、任何接下来的参数以及任何留在格式字符串中的字符，都被忽略</td></tr><tr><td style="text-align:left"><code>\f</code></td><td style="text-align:left">换页(formfeed)</td></tr><tr><td style="text-align:left"><code>\n</code></td><td style="text-align:left">换行</td></tr><tr><td style="text-align:left"><code>\r</code></td><td style="text-align:left">回车(Carriage return)</td></tr><tr><td style="text-align:left"><code>\t</code></td><td style="text-align:left">水平制表符</td></tr><tr><td style="text-align:left"><code>\v</code></td><td style="text-align:left">垂直制表符</td></tr><tr><td style="text-align:left"><code>\\</code></td><td style="text-align:left">一个字面上的反斜杠字符</td></tr><tr><td style="text-align:left"><code>\ddd</code></td><td style="text-align:left">表示1到3位数八进制值的字符。仅在格式字符串中有效</td></tr><tr><td style="text-align:left"><code>\0ddd</code></td><td style="text-align:left">表示1到3位的八进制值字符</td></tr></tbody></table><h3 id="test">test</h3><p>Shell中的 test 命令用于检查某个条件是否成立，它可以进行数值、字符和文件三个方面的测试。</p><ol><li>数值测试:</li></ol><table><thead><tr><th style="text-align:left">参数</th><th style="text-align:left">说明</th></tr></thead><tbody><tr><td style="text-align:left"><code>-eq</code></td><td style="text-align:left">等于则为真</td></tr><tr><td style="text-align:left"><code>-ne</code></td><td style="text-align:left">不等于则为真</td></tr><tr><td style="text-align:left"><code>-gt</code></td><td style="text-align:left">大于则为真</td></tr><tr><td style="text-align:left"><code>-ge</code></td><td style="text-align:left">大于等于则为真</td></tr><tr><td style="text-align:left"><code>-lt</code></td><td style="text-align:left">小于则为真</td></tr><tr><td style="text-align:left"><code>-le</code></td><td style="text-align:left">小于等于则为真</td></tr></tbody></table><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">num1=100</span><br><span class="line">num2=100</span><br><span class="line"><span class="keyword">if</span> <span class="built_in">test</span> $[num1] -eq $[num2]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&#x27;两个数相等！&#x27;</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&#x27;两个数不相等！&#x27;</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure><p>代码中的 [] 执行基本的算数运算，如：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">a=5</span><br><span class="line">b=6</span><br><span class="line"></span><br><span class="line">result=$[a+b] <span class="comment"># 注意等号两边不能有空格</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;result 为： <span class="variable">$result</span>&quot;</span> <span class="comment"># result 为： 11</span></span><br></pre></td></tr></table></figure><ol start="2"><li>字符串测试</li></ol><table><thead><tr><th style="text-align:left">参数</th><th style="text-align:left">说明</th></tr></thead><tbody><tr><td style="text-align:left"><code>=</code></td><td style="text-align:left">等于则为真</td></tr><tr><td style="text-align:left"><code>!=</code></td><td style="text-align:left">不相等则为真</td></tr><tr><td style="text-align:left"><code>-z</code></td><td style="text-align:left">字符串	字符串的长度为零则为真</td></tr><tr><td style="text-align:left"><code>-n</code></td><td style="text-align:left">字符串	字符串的长度不为零则为真</td></tr></tbody></table><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">num1=<span class="string">&quot;ru1noob&quot;</span></span><br><span class="line">num2=<span class="string">&quot;runoob&quot;</span></span><br><span class="line"><span class="keyword">if</span> <span class="built_in">test</span> <span class="variable">$num1</span> = <span class="variable">$num2</span></span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&#x27;两个字符串相等!&#x27;</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&#x27;两个字符串不相等!&#x27;</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure><ol start="3"><li>文件测试</li></ol><table><thead><tr><th style="text-align:left">参数</th><th style="text-align:left">说明</th></tr></thead><tbody><tr><td style="text-align:left"><code>-e</code> 文件名</td><td style="text-align:left">如果文件存在则为真</td></tr><tr><td style="text-align:left"><code>-r</code> 文件名</td><td style="text-align:left">如果文件存在且可读则为真</td></tr><tr><td style="text-align:left"><code>-w</code> 文件名</td><td style="text-align:left">如果文件存在且可写则为真</td></tr><tr><td style="text-align:left"><code>-x</code> 文件名</td><td style="text-align:left">如果文件存在且可执行则为真</td></tr><tr><td style="text-align:left"><code>-s</code> 文件名</td><td style="text-align:left">如果文件存在且至少有一个字符则为真</td></tr><tr><td style="text-align:left"><code>-d</code> 文件名</td><td style="text-align:left">如果文件存在且为目录则为真</td></tr><tr><td style="text-align:left"><code>-f</code> 文件名</td><td style="text-align:left">如果文件存在且为普通文件则为真</td></tr><tr><td style="text-align:left"><code>-c</code> 文件名</td><td style="text-align:left">如果文件存在且为字符型特殊文件则为真</td></tr><tr><td style="text-align:left"><code>-b</code> 文件名</td><td style="text-align:left">如果文件存在且为块特殊文件则为真</td></tr></tbody></table><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> <span class="built_in">test</span> -e ./bash</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&#x27;文件已存在!&#x27;</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&#x27;文件不存在!&#x27;</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure><ol start="4"><li>关联条件</li></ol><p>Shell 还提供了与( -a )、或( -o )、非( ! )三个逻辑操作符用于将测试条件连接起来，其优先级为： ! 最高， -a 次之， -o 最低。例如：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> <span class="built_in">test</span> -e ./notFile -o -e ./bash</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&#x27;至少有一个文件存在!&#x27;</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&#x27;两个文件都不存在&#x27;</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure><h3 id="declare">declare</h3><p>声明变量的属性，如果使用declare,后面没有任何参数，那么bash就会主动将所有变量名与内容都打印出来。</p><p>语 法：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">declare</span> [-aixr] variable</span><br></pre></td></tr></table></figure><p>参数说明：</p><ul><li>-a :将后面的variable定义为数组</li><li>-i :将后面的variavle定义为整数数字</li><li>-x :用法与export一样，就是将后面的variable变成环境变量</li><li>-r :将一个variable的亦是设置成只读，读变量不可更改内容，也不能unset</li></ul><h3 id="trap">trap</h3><p>trap命令的作用是：对捕获到的SIGNAL ，改变原有的处理action为新的action. trap -l 可以列出所有支持的signal. 语法格式： trap COMMAND SIGNAL_DEFINATION</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 退出钩子</span></span><br><span class="line">scratch=$(<span class="built_in">mktemp</span> -d -t tmp.XXXXXXXXXX)</span><br><span class="line"><span class="keyword">function</span> finish &#123;</span><br><span class="line">  <span class="built_in">rm</span> -rf <span class="string">&quot;<span class="variable">$scratch</span>&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">trap</span> finish EXIT</span><br><span class="line"></span><br><span class="line"><span class="comment"># Now your script can write files in the directory &quot;$scratch&quot;.</span></span><br><span class="line"><span class="comment"># It will automatically be deleted on exit, whether that&#x27;s due</span></span><br><span class="line"><span class="comment"># to an error, or normal completion.</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="Bash-配置">Bash 配置</h1><h2 id="IFS">IFS</h2><p>IFS变量 - 代表 Internal Field Separator - 控制 Bash 所谓的单词拆分。设置为字符串时，Bash 会将字符串中的每个字符视为分隔单词。这控制了 bash 将如何循环访问序列。例如:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line">names=(</span><br><span class="line">  <span class="string">&quot;Aaron Maxwell&quot;</span></span><br><span class="line">  <span class="string">&quot;Wayne Gretzky&quot;</span></span><br><span class="line">  <span class="string">&quot;David Beckham&quot;</span></span><br><span class="line">  <span class="string">&quot;Anderson da Silva&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;With default IFS value...&quot;</span></span><br><span class="line"><span class="keyword">for</span> name <span class="keyword">in</span> <span class="variable">$&#123;names[@]&#125;</span>; <span class="keyword">do</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$name</span>&quot;</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;With strict-mode IFS value...&quot;</span></span><br><span class="line">IFS=$<span class="string">&#x27;\n\t&#x27;</span></span><br><span class="line"><span class="keyword">for</span> name <span class="keyword">in</span> <span class="variable">$&#123;names[@]&#125;</span>; <span class="keyword">do</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$name</span>&quot;</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure><p>输出:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">With default IFS value...</span><br><span class="line">Aaron</span><br><span class="line">Maxwell</span><br><span class="line">Wayne</span><br><span class="line">Gretzky</span><br><span class="line">David</span><br><span class="line">Beckham</span><br><span class="line">Anderson</span><br><span class="line">da</span><br><span class="line">Silva</span><br><span class="line"></span><br><span class="line">With strict-mode IFS value...</span><br><span class="line">Aaron Maxwell</span><br><span class="line">Wayne Gretzky</span><br><span class="line">David Beckham</span><br><span class="line">Anderson da Silva</span><br></pre></td></tr></table></figure><p>考虑一个将文件名作为命令行参数的脚本：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> arg <span class="keyword">in</span> <span class="variable">$@</span>; <span class="keyword">do</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;doing something with file: <span class="variable">$arg</span>&quot;</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure><p><code>myscript.sh notes todo-list 'My Resume.doc'</code>,使用默认 IFS 值时，第三个参数将被错误地解析为两个单独的文件 - 名为“My”和“Resume.doc”。实际上，它是一个包含空格的文件.所以最好设置 <code>IFS=$'\n\t'</code>. 当然还可以这样解决问题: <code>for arg in &quot;$@&quot;; do</code></p><h2 id="配置项参数终止符">配置项参数终止符 <code>--</code></h2><p>-和–开头的参数，会被 Bash 当作配置项解释。但是，有时它们不是配置项，而是实体参数的一部分，比如文件名叫做-f或–file。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">cat</span> -f</span><br><span class="line">$ <span class="built_in">cat</span> --file</span><br></pre></td></tr></table></figure><p>上面命令的原意是输出文件-f和–file的内容，但是会被 Bash 当作配置项解释。</p><p>这时就可以使用配置项参数终止符–，它的作用是告诉 Bash，在它后面的参数开头的-和–不是配置项，只能当作实体参数解释。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">cat</span> -- -f</span><br><span class="line">$ <span class="built_in">cat</span> -- --file</span><br></pre></td></tr></table></figure><h1 id="编程规范">编程规范</h1><ul><li>[1] <a target="_blank" rel="noopener" href="https://google.github.io/styleguide/shellguide.html">google shell guide</a></li><li>[2] <a target="_blank" rel="noopener" href="https://github.com/koalaman/shellcheck">shellcheck: 静态脚本检查工具</a></li><li>[3] <a target="_blank" rel="noopener" href="http://redsymbol.net/articles/unofficial-bash-strict-mode">unofficial bash strict mode</a></li></ul></div><footer class="post-footer"><div class="reward-container"><div>请我一杯咖啡吧！</div><button>赞赏</button><div class="post-reward"><div><img src="/images/weixinpay.webp" alt="Victor Chu 微信"> <span>微信</span></div><div><img src="/images/alpay.webp" alt="Victor Chu 支付宝"> <span>支付宝</span></div></div></div><div class="post-copyright"><ul><li class="post-copyright-author"><strong>本文作者： </strong>Victor Chu</li><li class="post-copyright-link"><strong>本文链接：</strong> <a href="https://www.victorchu.info/posts/f621daf4/" title="shell 脚本速查">https://www.victorchu.info/posts/f621daf4/</a></li><li class="post-copyright-license"><strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！</li></ul></div><div class="followme"><span>欢迎关注我的其它发布渠道</span><div class="social-list"><div class="social-item"><a target="_blank" class="social-link" href="/atom.xml"><span class="icon"><i class="fa fa-rss"></i> </span><span class="label">RSS</span></a></div><div class="social-item"><a target="_blank" class="social-link" href="/images/wechat_channel.webp"><span class="icon"><i class="fab fa-weixin"></i> </span><span class="label">WeChat</span></a></div></div></div><div class="post-tags"><a href="/tags/Shell/" rel="tag"><i class="fa fa-tag"></i> Shell</a> <a href="/tags/Scripts/" rel="tag"><i class="fa fa-tag"></i> Scripts</a></div><div class="social-like a2a_kit a2a_kit_size_32 a2a_default_style"><a class="a2a_dd" target="_blank" rel="noopener" href="https://www.addtoany.com/share"></a> <a class="a2a_button_facebook"></a> <a class="a2a_button_twitter"></a> <a class="a2a_button_wechat"></a> <a class="a2a_button_pocket"></a> <a class="a2a_button_instapaper"></a> <a class="a2a_button_pinboard"></a> <a class="a2a_button_kindle_it"></a> <a class="a2a_button_copy_link"></a></div><div class="post-nav"><div class="post-nav-item"><a href="/posts/95e4137a/" rel="prev" title="Java8 lambda 底层实现原理"><i class="fa fa-angle-left"></i> Java8 lambda 底层实现原理</a></div><div class="post-nav-item"><a href="/posts/68f70fec/" rel="next" title="shell 脚本和snippets">shell 脚本和snippets <i class="fa fa-angle-right"></i></a></div></div></footer></article></div><div class="comments" id="waline"></div></div></main><footer class="footer"><div class="footer-inner"><div class="beian"><a href="https://beian.miit.gov.cn/" rel="noopener" target="_blank">浙ICP备18037908号-1 </a><img src="/images/gongan_icon.webp" alt=""><a href="https://beian.mps.gov.cn/#/query/webSearch?code=33010902002043" rel="noopener" target="_blank">浙公网安备 33010902002043号</a></div><div class="copyright">&copy; 2016 – <span itemprop="copyrightYear">2025</span> <span class="with-love"><i class="fa fa-heart"></i> </span><span class="author" itemprop="copyrightHolder">Victor Chu</span></div><div class="wordcount"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-chart-line"></i> </span><span title="站点总字数">1.9m</span> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-coffee"></i> </span><span title="站点阅读时长">53:07</span></span></div><div class="powered-by">由<a href="https://www.upyun.com/?utm_source=lianmeng&utm_medium=referral" class="theme-link" rel="noopener" target="_blank"><img src="/images/upyun_logo.webp" width="50" style="display:inline"></a>提供CDN服务</div></div></footer><div class="toggle sidebar-toggle" role="button"><span class="toggle-line"></span> <span class="toggle-line"></span> <span class="toggle-line"></span></div><div class="sidebar-dimmer"></div><div class="reading-progress-bar"></div><a role="button" class="book-mark-link book-mark-link-fixed"></a><noscript><div class="noscript-warning">Theme NexT works best with JavaScript enabled</div></noscript><script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fancyapps-ui/5.0.31/fancybox/fancybox.umd.js" integrity="sha256-a+H7FYzJv6oU2hfsfDGM2Ohw/cR9v+hPfxHCLdmCrE8=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/lozad.js/1.16.0/lozad.min.js" integrity="sha256-mOFREFhqmHeQbXpK2lp4nA3qooVgACfh88fpJftLBbc=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/pangu/4.0.7/pangu.min.js" integrity="sha256-j+yj56cdEY2CwkVtGyz18fNybFGpMGJ8JxG3GSyO2+I=" crossorigin="anonymous"></script><script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/sidebar.js"></script><script src="/js/next-boot.js"></script><script src="/js/bookmark.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/algoliasearch/4.23.3/algoliasearch-lite.umd.js" integrity="sha256-1QNshz86RqXe/qsCBldsUu13eAX6n/O98uubKQs87UI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/instantsearch.js/4.67.0/instantsearch.production.min.js" integrity="sha256-TW7D3X/i/W+RUgEeDppEnFT2ixv5lzplKH0c58D92dY=" crossorigin="anonymous"></script><script src="/js/third-party/search/algolia-search.js"></script><script class="next-config" data-name="mermaid" type="application/json">{"enable":true,"theme":"dark","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mermaid/10.9.0/mermaid.min.js","integrity":"sha256-stuqcu2FrjYCXDOytWFA5SoUE/r3nkp6gTglzNSlavU="}}</script><script src="/js/third-party/tags/mermaid.js"></script><script src="/js/third-party/fancybox.js"></script><script src="/js/third-party/pace.js"></script><script src="/js/third-party/addtoany.js"></script><script class="next-config" data-name="enableMath" type="application/json">false</script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css" integrity="sha256-UF1fgpAiu3tPJN/uCqEUHNe7pnr+QR0SQDNfgglgtcM=" crossorigin="anonymous"><script class="next-config" data-name="waline" type="application/json">{"lang":"zh-cn","enable":true,"serverURL":"walineui.victorchu.info","cssUrl":"https://cdn.staticfile.org/waline/2.15.8/waline.css","commentCount":true,"pageview":true,"requiredMeta":["nick","mail"],"login":"force","libUrl":"https://cdn.staticfile.org/waline/2.15.8/waline.js","dark":"body.darkmode--activated","el":"#waline","comment":true,"path":"/posts/f621daf4/"}</script><link rel="stylesheet" href="https://cdn.staticfile.org/waline/2.15.8/waline.css"><script>document.addEventListener('page:loaded', () => {
  NexT.utils.loadComments(CONFIG.waline.el).then(() =>
    NexT.utils.getScript(CONFIG.waline.libUrl, { condition: window.Waline })
  ).then(() => 
    Waline.init(Object.assign({}, CONFIG.waline,{ el: document.querySelector(CONFIG.waline.el) }))
  );
});</script><script src="https://cdn.jsdelivr.net/npm/darkmode-js@1.5.7/lib/darkmode-js.min.js"></script><script>var options = {
  bottom: '64px',
  right: '32px',
  left: 'unset',
  time: '0.5s',
  mixColor: 'transparent',
  backgroundColor: 'transparent',
  buttonColorDark: '#100f2c',
  buttonColorLight: '#fff',
  saveInCookies: true,
  label: '🌓',
  autoMatchOsTheme: true
}
const darkmode = new Darkmode(options);
window.darkmode = darkmode;
darkmode.showWidget();</script><script defer src="/_vercel/insights/script.js"></script><script defer src="/_vercel/speed-insights//script.js"></script><div class="moon-menu"><div class="moon-menu-items"><div id="moon-menu-item-back2bottom" class="moon-menu-item"><i class="fas fa-chevron-down"></i></div><div id="moon-menu-item-back2top" class="moon-menu-item"><i class="fas fa-chevron-up"></i></div></div><div class="moon-menu-button"><svg class="moon-menu-bg"><circle class="moon-menu-cricle" cx="50%" cy="50%" r="44%"></circle><circle class="moon-menu-border" cx="50%" cy="50%" r="48%"></circle></svg><div class="moon-menu-content"><div class="moon-menu-icon"><i class="fas fa-ellipsis-v"></i></div><div class="moon-menu-text"></div></div></div></div><script src="/js/injector.js"></script></body></html>