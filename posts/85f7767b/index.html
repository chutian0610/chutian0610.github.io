<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png"><link rel="mask-icon" href="/images/logo.svg" color="#222"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha256-XOqroi11tY4EFQMR9ZYwZWKj5ZXiftSx36RRuC3anlA=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancyapps-ui/5.0.31/fancybox/fancybox.css" integrity="sha256-gkQVf8UKZgQ0HyuxL/VnacadJ+D2Kox2TCEBuNQg5+w=" crossorigin="anonymous"><script class="next-config" data-name="main" type="application/json">{"hostname":"www.victorchu.info","root":"/","images":"/images","scheme":"Muse","darkmode":false,"version":"8.20.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12,"onmobile":true},"copycode":{"enable":true,"style":null,"show_result":"mac"},"fold":{"enable":false,"height":500},"bookmark":{"enable":true,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":true,"pangu":true,"comments":{"style":"tabs","active":"waline","storage":false,"lazyload":false,"nav":null,"activeClass":"waline"},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"algolia":{"appID":"X9UOD4FSUP","apiKey":"fa32db1f02073025c69da8ebad0a6aa6","indexName":"hexo-next-blog","hits":{"per_page":10}}}</script><script src="/js/config.js"></script><meta name="description" content="命令行的典型使用方式是，打开一个终端窗口（terminal window，以下简称&quot;窗口&quot;），在里面输入命令。用户与计算机的这种临时的交互，称为一次&quot;会话&quot;（session） 。 会话的一个重要特点是，窗口与其中启动的进程是连在一起的。打开窗口，会话开始；关闭窗口，会话结束，会话内部的进程也会随之终止，不管有没有运行完。 一个典型的例子就是，SSH 登录远程"><meta property="og:type" content="article"><meta property="og:title" content="linux命令tumx"><meta property="og:url" content="https://www.victorchu.info/posts/85f7767b/index.html"><meta property="og:site_name" content="代码之旅"><meta property="og:description" content="命令行的典型使用方式是，打开一个终端窗口（terminal window，以下简称&quot;窗口&quot;），在里面输入命令。用户与计算机的这种临时的交互，称为一次&quot;会话&quot;（session） 。 会话的一个重要特点是，窗口与其中启动的进程是连在一起的。打开窗口，会话开始；关闭窗口，会话结束，会话内部的进程也会随之终止，不管有没有运行完。 一个典型的例子就是，SSH 登录远程"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://www.victorchu.info/posts/85f7767b/tmux.webp"><meta property="og:image" content="https://www.victorchu.info/posts/85f7767b/tmux-view.webp"><meta property="article:published_time" content="2016-12-16T05:54:00.000Z"><meta property="article:modified_time" content="2024-07-30T12:51:51.507Z"><meta property="article:author" content="Victor Chu"><meta property="article:tag" content="Shell"><meta property="article:tag" content="Command"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://www.victorchu.info/posts/85f7767b/tmux.webp"><link rel="canonical" href="https://www.victorchu.info/posts/85f7767b/"><script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://www.victorchu.info/posts/85f7767b/","path":"/posts/85f7767b/","title":"linux命令tumx"}</script><script class="next-config" data-name="calendar" type="application/json">""</script><title>linux命令tumx | 代码之旅</title><script src="/js/third-party/analytics/baidu-analytics.js"></script><script async src="https://hm.baidu.com/hm.js?277fc29fa80de77c97f4f62b69e94233"></script><link rel="dns-prefetch" href="walineui.victorchu.info"><noscript><link rel="stylesheet" href="/css/noscript.css"></noscript><link rel="alternate" href="/atom.xml" title="代码之旅" type="application/atom+xml"></head><body itemscope itemtype="http://schema.org/WebPage" class="use-motion"><div class="headband"></div><main class="main"><div class="column"><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏" role="button"><span class="toggle-line"></span> <span class="toggle-line"></span> <span class="toggle-line"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><i class="logo-line"></i><p class="site-title">代码之旅</p><i class="logo-line"></i></a><p class="site-subtitle" itemprop="description">I love Coding !</p></div><div class="site-nav-right"><div class="toggle popup-trigger" aria-label="搜索" role="button"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class="site-nav"><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签<span class="badge">109</span></a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类<span class="badge">80</span></a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档<span class="badge">206</span></a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索</a></li></ul></nav><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"></div><span class="popup-btn-close" role="button"><i class="fa fa-times-circle"></i></span></div><div class="search-result-container"><div class="algolia-stats"><hr></div><div class="algolia-hits"></div><div class="algolia-pagination"></div></div></div></div></header><aside class="sidebar"><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class="sidebar-nav"><li class="sidebar-nav-toc">文章目录</li><li class="sidebar-nav-overview">站点概览</li></ul><div class="sidebar-panel-container"><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#tldr"><span class="nav-number">1.</span> <span class="nav-text">tldr</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#usage"><span class="nav-number">2.</span> <span class="nav-text">usage</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%89%E8%A3%85"><span class="nav-number">2.1.</span> <span class="nav-text">安装</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8tmux"><span class="nav-number">3.</span> <span class="nav-text">使用tmux</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BC%9A%E8%AF%9D"><span class="nav-number">3.1.</span> <span class="nav-text">会话</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AA%97%E5%8F%A3"><span class="nav-number">3.2.</span> <span class="nav-text">窗口</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AA%97%E6%A0%BC"><span class="nav-number">3.3.</span> <span class="nav-text">窗格</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AA%97%E6%A0%BC%E5%90%8C%E6%AD%A5%E6%93%8D%E4%BD%9C"><span class="nav-number">3.4.</span> <span class="nav-text">窗格同步操作</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%A8%E9%83%A8pane%E5%90%8C%E6%AD%A5"><span class="nav-number">3.4.1.</span> <span class="nav-text">全部pane同步</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%B0%83%E6%95%B4%E7%AA%97%E6%A0%BC%E5%B0%BA%E5%AF%B8"><span class="nav-number">3.5.</span> <span class="nav-text">调整窗格尺寸</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%85%B6%E4%BB%96%E5%91%BD%E4%BB%A4"><span class="nav-number">3.6.</span> <span class="nav-text">其他命令</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#tumx-%E9%85%8D%E7%BD%AE"><span class="nav-number">4.</span> <span class="nav-text">tumx 配置</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BF%AE%E6%94%B9%E6%8C%87%E4%BB%A4%E5%89%8D%E7%BC%80"><span class="nav-number">4.1.</span> <span class="nav-text">修改指令前缀</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#reload-%E9%85%8D%E7%BD%AE"><span class="nav-number">4.2.</span> <span class="nav-text">reload 配置</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%96%B0%E5%A2%9E%E9%9D%A2%E6%9D%BF"><span class="nav-number">4.3.</span> <span class="nav-text">新增面板</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%BC%A0%E6%A0%87%E6%94%AF%E6%8C%81"><span class="nav-number">4.4.</span> <span class="nav-text">鼠标支持</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%BF%AB%E9%80%9F%E9%9D%A2%E6%9D%BF%E5%88%87%E6%8D%A2"><span class="nav-number">4.5.</span> <span class="nav-text">快速面板切换</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%9D%A2%E6%9D%BF%E5%A4%A7%E5%B0%8F%E8%B0%83%E6%95%B4"><span class="nav-number">4.6.</span> <span class="nav-text">面板大小调整</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%9D%A2%E6%9D%BF%E6%9C%80%E5%A4%A7%E5%8C%96"><span class="nav-number">4.7.</span> <span class="nav-text">面板最大化</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AA%97%E5%8F%A3%E5%8F%98%E4%B8%BA%E9%9D%A2%E6%9D%BF"><span class="nav-number">4.8.</span> <span class="nav-text">窗口变为面板</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%85%B6%E4%BB%96%E9%85%8D%E7%BD%AE"><span class="nav-number">4.9.</span> <span class="nav-text">其他配置</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%81%A2%E5%A4%8D%E7%94%A8%E6%88%B7%E7%A9%BA%E9%97%B4"><span class="nav-number">4.10.</span> <span class="nav-text">恢复用户空间</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%A4%8D%E5%88%B6%E6%A8%A1%E5%BC%8F"><span class="nav-number">5.</span> <span class="nav-text">复制模式</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E5%A4%8D%E5%88%B6%E5%92%8C%E9%80%89%E6%8B%A9%E5%BF%AB%E6%8D%B7%E9%94%AE"><span class="nav-number">5.1.</span> <span class="nav-text">自定义复制和选择快捷键</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Buffer%E7%BC%93%E5%AD%98"><span class="nav-number">5.2.</span> <span class="nav-text">Buffer缓存</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E7%B3%BB%E7%BB%9F%E7%B2%98%E8%B4%B4%E6%9D%BF"><span class="nav-number">5.3.</span> <span class="nav-text">使用系统粘贴板</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9C%A8Linux%E4%B8%8A%E4%BD%BF%E7%94%A8%E7%B2%98%E8%B4%B4%E6%9D%BF"><span class="nav-number">5.3.1.</span> <span class="nav-text">在Linux上使用粘贴板</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9C%A8Mac%E4%B8%8A%E4%BD%BF%E7%94%A8%E7%B2%98%E8%B4%B4%E6%9D%BF"><span class="nav-number">5.3.2.</span> <span class="nav-text">在Mac上使用粘贴板</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%BF%9D%E5%AD%98Tmux%E4%BC%9A%E8%AF%9D"><span class="nav-number">6.</span> <span class="nav-text">保存Tmux会话</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Tmux-Resurrect"><span class="nav-number">6.1.</span> <span class="nav-text">Tmux Resurrect</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8F%AF%E9%80%89%E7%9A%84%E9%85%8D%E7%BD%AE"><span class="nav-number">6.1.1.</span> <span class="nav-text">可选的配置</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BF%9B%E9%98%B6%E7%9A%84%E5%A4%87%E4%BB%BD"><span class="nav-number">6.1.2.</span> <span class="nav-text">进阶的备份</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Tmux-Continuum"><span class="nav-number">6.2.</span> <span class="nav-text">Tmux Continuum</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#TPM"><span class="nav-number">6.3.</span> <span class="nav-text">TPM</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%BC%9A%E8%AF%9D%E5%85%B1%E4%BA%AB"><span class="nav-number">7.</span> <span class="nav-text">会话共享</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%85%B1%E4%BA%AB%E8%B4%A6%E5%8F%B7-%E7%BB%84%E4%BC%9A%E8%AF%9D"><span class="nav-number">7.1.</span> <span class="nav-text">共享账号&amp;组会话</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%8B%AC%E7%AB%8B%E8%B4%A6%E5%8F%B7-Socket%E5%85%B1%E4%BA%AB%E4%BC%9A%E8%AF%9D"><span class="nav-number">7.2.</span> <span class="nav-text">独立账号&amp;Socket共享会话</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Tmux%E4%BC%98%E5%8C%96"><span class="nav-number">8.</span> <span class="nav-text">Tmux优化</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E8%84%9A%E6%9C%AC%E5%8C%96%E7%9A%84Tmux"><span class="nav-number">9.</span> <span class="nav-text">脚本化的Tmux</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#tmux-%E5%AE%9E%E7%8E%B0%E5%B9%B3%E9%93%BA%E8%A7%86%E5%9B%BE"><span class="nav-number">9.1.</span> <span class="nav-text">tmux 实现平铺视图</span></a></li></ol></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" alt="Victor Chu" src="/images/victor-blog-head.webp"><p class="site-author-name" itemprop="name">Victor Chu</p><div class="site-description" itemprop="description">blog about programming.</div></div><div class="site-state-wrap animated"><nav class="site-state"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">206</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/"><span class="site-state-item-count">80</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"><a href="/tags/"><span class="site-state-item-count">109</span> <span class="site-state-item-name">标签</span></a></div></nav></div><div class="links-of-author animated"><span class="links-of-author-item"><a href="https://github.com/chutian0610" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;chutian0610" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a> </span><span class="links-of-author-item"><a href="mailto:victorchu0610@outlook.com" title="E-Mail → mailto:victorchu0610@outlook.com" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a> </span><span class="links-of-author-item"><a href="https://www.zhihu.com/people/victorchu" title="Zhihu → https:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;victorchu" rel="noopener me" target="_blank"><i class="fab fa-zhihu fa-fw"></i>Zhihu</a> </span><span class="links-of-author-item"><a href="/images/Wechat.webp" title="WeChat → &#x2F;images&#x2F;Wechat.webp" rel="noopener me"><i class="fa-brands fa-weixin fa-fw"></i>WeChat</a></span></div></div></div><div class="back-to-top animated" role="button" aria-label="返回顶部"><i class="fa fa-arrow-up"></i> <span>0%</span></div></div><div class="sidebar-inner sidebar-blogroll"><div class="links-of-blogroll animated"><div class="links-of-blogroll-title"><i class="fa fa-globe fa-fw"></i> 链接</div><ul class="links-of-blogroll-list"><li class="links-of-blogroll-item"><a href="https://www.tpfuture.top/" title="https:&#x2F;&#x2F;www.tpfuture.top&#x2F;" rel="noopener" target="_blank">一水轩</a></li></ul></div></div></aside></div><div class="main-inner post posts-expand"><div class="post-block"><article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://www.victorchu.info/posts/85f7767b/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/victor-blog-head.webp"><meta itemprop="name" content="Victor Chu"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="代码之旅"><meta itemprop="description" content="blog about programming."></span><span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork"><meta itemprop="name" content="linux命令tumx | 代码之旅"><meta itemprop="description" content=""></span><header class="post-header"><h1 class="post-title" itemprop="name headline">linux命令tumx</h1><div class="post-meta-container"><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2016-12-16 13:54:00" itemprop="dateCreated datePublished" datetime="2016-12-16T13:54:00+08:00">2016-12-16</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i> </span><span class="post-meta-item-text">更新于</span> <time title="修改时间：2024-07-30 20:51:51" itemprop="dateModified" datetime="2024-07-30T20:51:51+08:00">2024-07-30</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Shell/" itemprop="url" rel="index"><span itemprop="name">Shell</span></a> </span></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-comment"></i> </span><span class="post-meta-item-text">Waline：</span> <a title="waline" href="/posts/85f7767b/#waline" itemprop="discussionUrl"><span class="post-comments-count waline-comment-count" data-path="/posts/85f7767b/" itemprop="commentCount"></span> </a></span><span class="post-meta-item" title="阅读次数"><span class="post-meta-item-icon"><i class="far fa-eye"></i> </span><span class="post-meta-item-text">阅读次数：</span> <span class="waline-pageview-count" data-path="/posts/85f7767b/"></span> </span><span class="post-meta-break"></span> <span class="post-meta-item" title="本文字数"><span class="post-meta-item-icon"><i class="far fa-file-word"></i> </span><span class="post-meta-item-text">本文字数：</span> <span>21k</span> </span><span class="post-meta-item" title="阅读时长"><span class="post-meta-item-icon"><i class="far fa-clock"></i> </span><span class="post-meta-item-text">阅读时长 &asymp;</span> <span>35 分钟</span></span></div></div></header><div class="post-body" itemprop="articleBody"><p>命令行的典型使用方式是，打开一个终端窗口（terminal window，以下简称&quot;窗口&quot;），在里面输入命令。用户与计算机的这种临时的交互，称为一次&quot;会话&quot;（session） 。</p><p>会话的一个重要特点是，窗口与其中启动的进程是连在一起的。打开窗口，会话开始；关闭窗口，会话结束，会话内部的进程也会随之终止，不管有没有运行完。</p><p>一个典型的例子就是，SSH 登录远程计算机，打开一个远程窗口执行命令。这时，网络突然断线，再次登录的时候，是找不回上一次执行的命令的。因为上一次 SSH 会话已经终止了，里面的进程也随之消失了。</p><p>为了解决这个问题，会话与窗口可以&quot;解绑&quot;：窗口关闭时，会话并不终止，而是继续运行，等到以后需要的时候，再让会话&quot;绑定&quot;其他窗口。</p><span id="more"></span><h1 id="tldr">tldr</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Start a new session:</span></span><br><span class="line">tmux</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Start a new named session:</span></span><br><span class="line">tmux new -s name</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">List existing sessions:</span></span><br><span class="line">tmux ls</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Attach to the most recently used session:</span></span><br><span class="line">tmux attach</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Detach from the current session (inside a tmux session):</span></span><br><span class="line">Ctrl-B d</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Create a new window (inside a tmux session):</span></span><br><span class="line">Ctrl-B c</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Switch between sessions and windows (inside a tmux session):</span></span><br><span class="line">Ctrl-B w</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Kill a session by name:</span></span><br><span class="line">tmux kill-session -t name</span><br></pre></td></tr></table></figure><h1 id="usage">usage</h1><blockquote><p><a target="_blank" rel="noopener" href="https://github.com/tmux/tmux">tumx</a>: Terminal multiplexer. It allows multiple sessions with windows, panes, and more.</p></blockquote><p>Tmux 就是会话与窗口的&quot;解绑&quot;工具，通过C-S架构将它们彻底分离。</p><figure><img data-src="/posts/85f7767b/tmux.webp" alt="tmux"></figure><p>类似的终端复用器还有 GNU Screen。Tmux 与它功能相似，但是更易用，也更强大。</p><h2 id="安装">安装</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Ubuntu 或 Debian</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo apt-get install tmux</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">CentOS 或 Fedora</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo yum install tmux</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Mac</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">brew install tmux</span></span><br></pre></td></tr></table></figure><h1 id="使用tmux">使用tmux</h1><figure><img data-src="/posts/85f7767b/tmux-view.webp" alt="tmux-view"></figure><p>如图所示上面就是tmux的日常使用界面。</p><p>最下面是状态栏 ，状态栏左侧 <code>[test] 0:zsh* 1:vim~</code> 中test 是指session name，0是指session下的第一个window。<code>zsh*</code> 是窗口名。状态栏右侧是当前机器信息。</p><blockquote><p>Tmux 窗口有大量的快捷键。所有快捷键都要通过前缀键唤起。默认的前缀键是Ctrl+b，即先按下Ctrl+b，快捷键才会生效。举例来说，帮助命令的快捷键是Ctrl+b ?。它的用法是，在 Tmux 窗口中，先按下Ctrl+b，再按下?，就会显示帮助信息。</p></blockquote><h2 id="会话">会话</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">新建会话</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">tmux</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">新建一个命名会话</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">tmux new -s &lt;name&gt;</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">查看当前所有tmux会话</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">tmux <span class="built_in">ls</span></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">接入最常使用的会话:</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">tmux attach</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">接入会话</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"> 命名</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">tmux attach -t &lt;name&gt;</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"> 使用编号</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">tmux attach -t 0</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">当前会话和窗口分离</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">tmux detach</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">杀死会话</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"> 命名</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">tmux kill-session -t &lt;name&gt;</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"> 编号</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">tmux kill-session -t 0</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">重命名会话</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">tmux rename-session -t 0 &lt;new-name&gt;</span></span><br></pre></td></tr></table></figure><p>除了会话命令，tmux在还支持一些会话快捷键。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Ctrl+b d：分离当前会话。</span><br><span class="line">Ctrl+b s：列出所有会话。</span><br><span class="line">Ctrl+b $：重命名当前会话。</span><br></pre></td></tr></table></figure><h2 id="窗口">窗口</h2><p>tmux的session会默认有一个窗口。也就是窗口0。此外Tmux 也允许新建多个窗口。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">新建窗口</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">tmux new-window</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">新建一个指定名称的窗口</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">tmux new-window -n &lt;window-name&gt;</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">切换到指定编号的窗口</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">tmux select-window -t &lt;window-number&gt;</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">切换到指定名称的窗口</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">tmux select-window -t &lt;window-name&gt;</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">重命名窗口</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">tmux rename-window &lt;new-name&gt;</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">交换 3 号和 1 号窗口</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">tmux swap-window -s 3 -t 1</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"> 交换当前和 1 号窗口</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">tmux swap-window -t 1</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">移动当前窗口到 1 号</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">tmux  move-window -t 1</span></span><br></pre></td></tr></table></figure><p>下面是一些窗口操作的快捷键。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Ctrl+b c #创建一个新窗口，状态栏会显示多个窗口的信息。</span><br><span class="line">Ctrl+b p #切换到上一个窗口（按照状态栏上的顺序）。</span><br><span class="line">Ctrl+b n #切换到下一个窗口。</span><br><span class="line">Ctrl+b &lt;number&gt; # 切换到指定编号的窗口，其中的&lt;number&gt;是状态栏上的窗口编号。</span><br><span class="line">Ctrl+b w #从列表中选择窗口。</span><br><span class="line">Ctrl+b f # 从列表中查找窗口。</span><br><span class="line">Ctrl+b , #窗口重命名。</span><br><span class="line">Ctrl+b &amp; # kill 窗口</span><br><span class="line">Ctrl-b :swap-window -s [0-9] -t [0-9] #交换窗口</span><br><span class="line">Ctrl-b : rename-window &lt;new name&gt; # 窗口重命名</span><br></pre></td></tr></table></figure><h2 id="窗格">窗格</h2><p>Tmux 可以将窗口分成多个窗格（pane），每个窗格运行不同的命令。以下命令都是在 Tmux 窗口中执行。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">划分上下两个窗格</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">tmux split-window -v</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">划分左右两个窗格</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">tmux split-window -h</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">光标切换到上方窗格</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">tmux select-pane -U</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">光标切换到下方窗格</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">tmux select-pane -D</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">光标切换到左边窗格</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">tmux select-pane -L</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">光标切换到右边窗格</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">tmux select-pane -R</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">当前窗格上移</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">tmux swap-pane -U</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">当前窗格下移</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">tmux swap-pane -D</span></span><br></pre></td></tr></table></figure><p>下面是一些窗格的快捷键</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">`Ctrl+b %`：划分左右两个窗格。</span><br><span class="line">`Ctrl+b &quot;`：划分上下两个窗格。</span><br><span class="line">`Ctrl+b &lt;arrow key&gt;`：光标切换到其他窗格。&lt;arrow key&gt;是指向要切换到的窗格的方向键，比如切换到下方窗格，就按方向键↓。</span><br><span class="line">`Ctrl+b ;` ：光标切换到上一个窗格。</span><br><span class="line">`Ctrl+b o` ：光标切换到下一个窗格。</span><br><span class="line">`Ctrl+b &#123;`：当前窗格与上一个窗格交换位置。</span><br><span class="line">`Ctrl+b &#125;`：当前窗格与下一个窗格交换位置。</span><br><span class="line">`Ctrl+b Ctrl+o`：顺时针旋转当前窗口中的所有面板</span><br><span class="line">`Ctrl+b Alt+o`：逆时针旋转当前窗口中的所有面板</span><br><span class="line">`Ctrl+b x`：关闭当前窗格。</span><br><span class="line">`Ctrl+b !`：将当前窗格拆分为一个独立窗口。</span><br><span class="line">`Ctrl+b z`：当前窗格全屏显示，再使用一次会变回原来大小。</span><br><span class="line">`Ctrl+b Ctrl+&lt;arrow key&gt;`：以1个单元格为单位调整当前面板边缘（Mac下被系统快捷键覆盖）</span><br><span class="line">`Ctrl+b Alt+&lt;arrow key&gt;`：以5个单元格为单位调整当前面板边缘</span><br><span class="line">`Ctrl+b q`：显示窗格编号。在编号消失前输入对应的数字可切换到相应的面板</span><br><span class="line">`Ctrl+b t`: 显示时钟。</span><br></pre></td></tr></table></figure><h2 id="窗格同步操作">窗格同步操作</h2><p>tmux 支持在窗口中的多个窗格同时输入，输入 Tmux 前缀(Ctrl+b)和一个冒号呼出命令提示行，然后输入<code>setw synchronize-panes</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Ctrl+b : setw synchronize-panes</span><br></pre></td></tr></table></figure><p>可以指定同步窗格开或关，重复执行命令会在两者间切换。这个选项值针对某个窗口有效，不会影响别的会话和窗口。</p><h3 id="全部pane同步">全部pane同步</h3><p>在 <code>.tmux.conf</code> 中加上如下绑定键:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">bind</span> E command-prompt -p <span class="string">&quot;Command:&quot;</span> \</span><br><span class="line">       <span class="string">&quot;run \&quot;tmux list-panes -a -F &#x27;##&#123;session_name&#125;:##&#123;window_index&#125;.##&#123;pane_index&#125;&#x27; \</span></span><br><span class="line"><span class="string">              | xargs -I PANE tmux send-keys -t PANE &#x27;%1&#x27; Enter\&quot;&quot;</span></span><br></pre></td></tr></table></figure><ul><li>在任何窗格中键入<code>Ctrl+b E</code></li><li>输入要发送到所有窗格的命令，回车结束</li></ul><h2 id="调整窗格尺寸">调整窗格尺寸</h2><p>如果不喜欢默认布局，可以重调窗格的尺寸。这几个命令用来调整窗格(通过命令提示行方式修改)：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Ctrl+b : resize-pane -D          当前窗格向下扩大 1 格</span><br><span class="line">Ctrl+b : resize-pane -U          当前窗格向上扩大 1 格</span><br><span class="line">Ctrl+b : resize-pane -L          当前窗格向左扩大 1 格</span><br><span class="line">Ctrl+b : resize-pane -R          当前窗格向右扩大 1 格</span><br><span class="line">Ctrl+b : resize-pane -D 20       当前窗格向下扩大 20 格</span><br><span class="line">Ctrl+b : resize-pane -t 2 -L 20  编号为 2 的窗格向左扩大 20 格</span><br></pre></td></tr></table></figure><h2 id="其他命令">其他命令</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">列出所有快捷键，及其对应的 Tmux 命令</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">tmux list-keys</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">列出所有 Tmux 命令及其参数</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">tmux list-commands</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">列出当前所有 Tmux 会话的信息</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">tmux info</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">重新加载当前的 Tmux 配置</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">tmux source-file ~/.tmux.conf</span></span><br></pre></td></tr></table></figure><h1 id="tumx-配置">tumx 配置</h1><p>相信只要你用过几次tmux，就会发现Ctrl+b指令前缀，着实不太方便。这两个键相距太远，按键成本太高了。因此我们首先需要将它更换为距离更近的Ctrl+a组合键，或者不常用的 ` 键（当然其他键也是可以的）。tmux的用户级配置文件为~/.tmux.conf（没有的话就创建一个）。</p><h2 id="修改指令前缀">修改指令前缀</h2><p>修改tmux指令前缀，只需要增加如下三行即可。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">set -g prefix C-a #</span><br><span class="line">unbind C-b # C-b即Ctrl+b键，unbind意味着解除绑定</span><br><span class="line">bind C-a send-prefix # 绑定Ctrl+a为新的指令前缀</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">从tmux v1.6版起，支持设置第二个指令前缀</span></span><br><span class="line">set-option -g prefix2 ` # 设置一个不常用的 ` 键作为指令前缀，按键更快些</span><br></pre></td></tr></table></figure><h2 id="reload-配置">reload 配置</h2><p>修改的~/.tmux.conf配置文件有如下两种方式可以令其生效：</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1. restart tmux。</span><br><span class="line">2. 在tmux窗口中，先按下Ctrl+b指令前缀，然后按下冒号 : ，进入到命令模式后输入source-file ~/.tmux.conf，回车后生效。</span><br></pre></td></tr></table></figure><p>更为优雅的做法是新增一个加载配置文件的快捷指令 ，这样就可以随时随地load新的配置了，如下所示。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">绑定快捷键为r</span></span><br><span class="line">bind r source-file ~/.tmux.conf \; display-message &quot;Config reloaded..&quot;</span><br></pre></td></tr></table></figure><h2 id="新增面板">新增面板</h2><p>tmux中，使用最多的功能之一就是新增一个面板。水平方向新增面板的指令是 <code>Ctrl+b &quot;</code> ，垂直方向是 <code>Ctrl+b %</code>，&quot; 和 %需要两个键同时按下才能完成，加上指令前缀至少需要3~4次按键才能组成一个完整的指令，同时这个两个键也不够醒目和方便，因此我们可以绑定两个更常用的指令 -、|，如下所示：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">unbind &#x27;&quot;&#x27;</span><br><span class="line">bind - splitw -v -c &#x27;#&#123;pane_current_path&#125;&#x27; # 垂直方向新增面板，默认进入当前目录</span><br><span class="line">unbind %</span><br><span class="line">bind | splitw -h -c &#x27;#&#123;pane_current_path&#125;&#x27; # 水平方向新增面板，默认进入当前目录</span><br></pre></td></tr></table></figure><h2 id="鼠标支持">鼠标支持</h2><p>默认情况下，tmux的多窗口之间的切换以及面板大小调整，需要输入指令才能完成，这一过程，涉及到的指令较多，而且操作麻烦，特别是面板大小调整，指令难以一步到位，这个时候开启鼠标支持就完美了。</p><p>对于tmux v2.1(2015.10.28)之前的版本，需加入如下配置：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">setw -g mode-mouse on # 支持鼠标选取文本等</span><br><span class="line">setw -g mouse-resize-pane on # 支持鼠标拖动调整面板的大小(通过拖动面板间的分割线)</span><br><span class="line">setw -g mouse-select-pane on # 支持鼠标选中并切换面板</span><br><span class="line">setw -g mouse-select-window on # 支持鼠标选中并切换窗口(通过点击状态栏窗口名称)</span><br></pre></td></tr></table></figure><p>有的地方可能会出现set-window-option的写法，setw就是它的别名。</p><p>对于tmux v2.1及以上的版本，仅需加入如下配置：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">set-option -g mouse on # 等同于以上4个指令的效果</span><br></pre></td></tr></table></figure><blockquote><p>需要注意的是，开启鼠标支持后，iTem2默认的鼠标选中即复制功能需要同时按下 Alt 键，才会生效。</p></blockquote><h2 id="快速面板切换">快速面板切换</h2><p>指令前缀加方向键可以切换面板，但方向键太远，不够快，不够Geek。没关系，我们可以将面板切换升级为熟悉的h、j、k、l键位。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">绑定hjkl键为面板切换的上下左右键</span></span><br><span class="line">bind -r k select-pane -U # 绑定k为↑</span><br><span class="line">bind -r j select-pane -D # 绑定j为↓</span><br><span class="line">bind -r h select-pane -L # 绑定h为←</span><br><span class="line">bind -r l select-pane -R # 绑定l为→</span><br></pre></td></tr></table></figure><p>-r表示可重复按键，大概500ms之内，重复的h、j、k、l按键都将有效，完美支持了快速切换的Geek需求。</p><p>除了上下左右外， 还有几个快捷指令可以设置。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">bind -r e lastp # 选择最后一个面板</span><br><span class="line">bind -r ^e last # 选择最后一个窗口</span><br><span class="line"></span><br><span class="line">bind -r ^u swapp -U # 与前一个面板交换位置</span><br><span class="line">bind -r ^d swapp -D # 与后一个面板交换位置</span><br></pre></td></tr></table></figure><h2 id="面板大小调整">面板大小调整</h2><p>习惯了全键盘操作后，命令的便捷性不言而喻。既然面板切换的指令都可以升级，面板大小调整的指令自然也不能落后。如下配置就可以升级你的操作：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">绑定Ctrl+hjkl键为面板上下左右调整边缘的快捷指令</span></span><br><span class="line">bind -r ^k resizep -U 10 # 绑定Ctrl+k为往↑调整面板边缘10个单元格</span><br><span class="line">bind -r ^j resizep -D 10 # 绑定Ctrl+j为往↓调整面板边缘10个单元格</span><br><span class="line">bind -r ^h resizep -L 10 # 绑定Ctrl+h为往←调整面板边缘10个单元格</span><br><span class="line">bind -r ^l resizep -R 10 # 绑定Ctrl+l为往→调整面板边缘10个单元格</span><br></pre></td></tr></table></figure><h2 id="面板最大化">面板最大化</h2><p>当窗口中面板的数量逐渐增多时，每个面板的空间就会逐渐减少。为了保证有足够的空间显示内容，tmux从v1.8版本起，提供了面板的最大化功能，输入<code>Ctrl+b z</code>，就可以最大化当前面板至窗口大小，只要再重复输入一次，便恢复正常。那么tmux v1.8以下的版本，怎么办呢？别急，有大神提供了如下的解决方案。</p><p>首先编写一个zoom脚本，该脚本通过新建一个窗口，交换当前面板与新的窗口默认面板位置，来模拟最大的功能；通过重复一次按键，还原面板位置，并关闭新建的窗口，来模拟还原功能，如下所示：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash -f</span></span><br><span class="line">currentwindow=`tmux list-window | tr &#x27;\t&#x27; &#x27; &#x27; | sed -n -e &#x27;/(active)/s/^[^:]*: *\([^ ]*\) .*/\1/gp&#x27;`;</span><br><span class="line">currentpane=`tmux list-panes | sed -n -e &#x27;/(active)/s/^\([^:]*\):.*/\1/gp&#x27;`;</span><br><span class="line">panecount=`tmux list-panes | wc | sed -e &#x27;s/^ *//g&#x27; -e &#x27;s/ .*$//g&#x27;`;</span><br><span class="line">inzoom=`echo $currentwindow | sed -n -e &#x27;/^zoom/p&#x27;`;</span><br><span class="line">if [ $panecount -ne 1 ]; then</span><br><span class="line">    inzoom=&quot;&quot;;</span><br><span class="line">fi</span><br><span class="line">if [ $inzoom ]; then</span><br><span class="line">    lastpane=`echo $currentwindow | rev | cut -f 1 -d &#x27;@&#x27; | rev`;</span><br><span class="line">    lastwindow=`echo $currentwindow | cut -f 2- -d &#x27;@&#x27; | rev | cut -f 2- -d &#x27;@&#x27; | rev`;</span><br><span class="line">    tmux select-window -t $lastwindow;</span><br><span class="line">    tmux select-pane -t $lastpane;</span><br><span class="line">    tmux swap-pane -s $currentwindow;</span><br><span class="line">    tmux kill-window -t $currentwindow;</span><br><span class="line">else</span><br><span class="line">    newwindowname=zoom@$currentwindow@$currentpane;</span><br><span class="line">    tmux new-window -d -n $newwindowname;</span><br><span class="line">    tmux swap-pane -s $newwindowname;</span><br><span class="line">    tmux select-window -t $newwindowname;</span><br><span class="line">fi</span><br></pre></td></tr></table></figure><p>不妨将该脚本存放在~/.tmux目录中（没有则新建目录），接下来只需要绑定一个快捷指令就行，如下。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">unbind z</span><br><span class="line">bind z run &quot;. ~/.tmux/zoom&quot;</span><br></pre></td></tr></table></figure><h2 id="窗口变为面板">窗口变为面板</h2><p>通过上面的zoom脚本，面板可以轻松地最大化为一个新的窗口。那么反过来，窗口是不是可以最小化为一个面板呢？</p><p>试想这样一个场景：当你打开多个窗口后，然后想将其中几个窗口合并到当前窗口中，以便对比观察输出。</p><p><code>Ctrl+b :</code>，打开命令行，然后输入如下命令：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">join-pane -s window01 # 合并名称为window01的窗口的默认（第一个）面板到当前窗口中</span><br><span class="line">join-pane -s window01.1 # .1显式指定了第一个面板，.2就是第二个面板(我本地将面板编号起始值设置为1，默认是0)</span><br></pre></td></tr></table></figure><p>每次执行join-pane命令都会合并一个面板，并且指定的窗口会减少一个面板，直到面板数量为0，窗口关闭。</p><p>除了在当前会话中操作外，join-pane命令甚至可以从其它指定会话中合并面板，格式为 <code>join-pane -s [session_name]:[window].[pane]</code>，如<code>join-pane -s 2:1.1</code>即合并第二个会话的第一个窗口的第一个面板到当前窗口，当目标会话的窗口和面板数量为0时，会话便会关闭。</p><blockquote><p>注：上一节中的swap-pane命令与join-pane语法基本一致。</p></blockquote><h2 id="其他配置">其他配置</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">bind m command-prompt &quot;splitw -h &#x27;exec man %%&#x27;&quot;   # 绑定m键为在新的panel打开man</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">绑定P键为开启日志功能，如下，面板的输出日志将存储到桌面</span></span><br><span class="line">bind P pipe-pane -o &quot;cat &gt;&gt;~/Desktop/#W.log&quot; \; display &quot;Toggled logging to ~/Desktop/#W.log&quot;</span><br></pre></td></tr></table></figure><h2 id="恢复用户空间">恢复用户空间</h2><p>tmux会话中，Mac的部分命令如 osascript、open、pbcopy 或 pbpaste等可能会失效（失效命令未列全）。</p><p>部分bug列表如下：</p><ul><li><a target="_blank" rel="noopener" href="http://louiszhai.github.io/2017/09/30/tmux/#:~:text=applescript%20%2D%20Unable%20to%20run%20%E2%80%98display%20notification%E2%80%99%20using%20osascript%20in%20a%20tmux%20session">applescript - Unable to run ‘display notification’ using osascript in a tmux session</a></li><li><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/30404944/open-command-doesnt-work-properly-inside-tmux/30412054#30412054">osx - “open” command doesn’t work properly inside tmux</a></li><li><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/16618992/cant-paste-into-macvim/16661806#16661806">clipboard - Can’t paste into MacVim</a></li></ul><p>对此，我们可以通过安装reattach-to-user-namespace包装程序来解决这个问题。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install reattach-to-user-namespace</span><br></pre></td></tr></table></figure><p>在~/.tmux.conf中添加配置：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">set -g default-command &quot;reattach-to-user-namespace -l $SHELL&quot;</span><br></pre></td></tr></table></figure><p>这样你的交互式shell最终能够重新连接到用户级的命名空间。由于连接状态能够被子进程继承，故以上配置保证了所有从 shell 启动的命令能够被正确地连接。</p><p>有些时候，我们可能会在不同的操作系统中共享配置文件，如果你的tmux版本大于1.9，我们还可以使用if-shell来判断是否Mac系统，然后再指定default-command。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">if-shell &#x27;test &quot;$(uname -s)&quot; = Darwin&#x27; &#x27;set-option -g default-command &quot;exec reattach-to-user-namespace -l $SHELL&quot;&#x27;</span><br></pre></td></tr></table></figure><p>对于tmux v1.8及更早的版本，可以使用如下包装后的配置：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">set-option -g default-command &#x27;command -v reattach-to-user-namespace &gt;/dev/null &amp;&amp; exec reattach-to-user-namespace -l &quot;$SHELL&quot; || exec &quot;$SHELL&quot;&#x27;</span><br></pre></td></tr></table></figure><p>以上，<code>$SHELL</code>对应于你的默认Shell，通常是/usr/bin/bash 或 /usr/local/bin/zsh。</p><h1 id="复制模式">复制模式</h1><p>tmux中操作文本，自然离不开复制模式，通常使用复制模式的步骤如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">输入 `Ctrl+b [` 进入复制模式</span><br><span class="line">按下 空格键 开始复制，移动光标选择复制区域</span><br><span class="line">按下 回车键 复制选中文本并退出复制模式</span><br><span class="line">按下 `Ctrl+b ]` 粘贴文本</span><br></pre></td></tr></table></figure><p>查看复制模式默认的快捷键风格：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tmux show-window-options -g mode-keys # mode-keys emacs</span><br></pre></td></tr></table></figure><p>默认情况下，快捷键为emacs风格。</p><p>为了让复制模式更加方便，我们可以将快捷键设置为熟悉的vi风格，如下：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">setw -g mode-keys vi # 开启vi风格后，支持vi的C-d、C-u、hjkl等快捷键</span><br></pre></td></tr></table></figure><h2 id="自定义复制和选择快捷键">自定义复制和选择快捷键</h2><p>除了快捷键外，复制模式的启用、选择、复制、粘贴等按键也可以向vi风格靠拢。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">bind Escape copy-mode # 绑定esc键为进入复制模式</span><br><span class="line">bind -t vi-copy v begin-selection # 绑定v键为开始选择文本</span><br><span class="line">bind -t vi-copy y copy-selection # 绑定y键为复制选中文本</span><br><span class="line">bind p pasteb # 绑定p键为粘贴文本（p键默认用于进入上一个窗口，不建议覆盖）</span><br></pre></td></tr></table></figure><p>以上，绑定 v、y两键的设置只在tmux v2.4版本以下才有效，对于v2.4及以上的版本，绑定快捷键需要使用 -T 选项，发送指令需要使用 -X 选项，请参考如下设置：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">bind -T copy-mode-vi v send-keys -X begin-selection</span><br><span class="line">bind -T copy-mode-vi y send-keys -X copy-selection-and-cancel</span><br></pre></td></tr></table></figure><h2 id="Buffer缓存">Buffer缓存</h2><p>tmux复制操作的内容默认会存进buffer里，buffer是一个粘贴缓存区，新的缓存总是位于栈顶，它的操作命令如下：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">tmux list-buffers # 展示所有的 buffers</span><br><span class="line">tmux show-buffer [-b buffer-name] # 显示指定的 buffer 内容</span><br><span class="line">tmux choose-buffer # 进入 buffer 选择页面(支持jk上下移动选择，回车选中并粘贴 buffer 内容到面板上)</span><br><span class="line">tmux set-buffer # 设置buffer内容</span><br><span class="line">tmux load-buffer [-b buffer-name] file-path # 从文件中加载文本到buffer缓存</span><br><span class="line">tmux save-buffer [-a] [-b buffer-name] path # 保存tmux的buffer缓存到本地</span><br><span class="line">tmux paste-buffer # 粘贴buffer内容到会话中</span><br><span class="line">tmux delete-buffer [-b buffer-name] # 删除指定名称的buffer</span><br></pre></td></tr></table></figure><p>以上buffer操作在不指定buffer-name时，默认处理是栈顶的buffer缓存。在tmux会话的命令行输入时，可以省略上述tmux前缀。默认情况下，buffers内容是独立于系统粘贴板的，它存在于tmux进程中，且可以在会话间共享。</p><h2 id="使用系统粘贴板">使用系统粘贴板</h2><p>存在于tmux进程中的buffer缓存，虽然可以在会话间共享，但不能直接与系统粘贴板共享，不免有些遗憾。幸运的是，现在我们有成熟的方案来实现这个功能。</p><h3 id="在Linux上使用粘贴板">在Linux上使用粘贴板</h3><p>通常，Linux中可以使用xclip工具来接入系统粘贴板。</p><p>首先，需要安装xclip。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install xclip</span><br></pre></td></tr></table></figure><p>然后，.tmux.conf的配置如下。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">buffer缓存复制到Linux系统粘贴板</span></span><br><span class="line">bind C-c run &quot; tmux save-buffer - | xclip -i -sel clipboard&quot;</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Linux系统粘贴板内容复制到会话</span></span><br><span class="line">bind C-v run &quot; tmux set-buffer \&quot;$(xclip -o -sel clipboard)\&quot;; tmux paste-buffer&quot;</span><br></pre></td></tr></table></figure><p>按下<code>Ctrl+b Ctrl+c</code> 键，buffer缓存的内容将通过xlip程序复制到粘贴板，按下 <code>Ctrl+b Ctrl+v</code>，tmux将通过xclip访问粘贴板，然后由set-buffer命令设置给buffer缓存，最后由paste-buffer粘贴到tmux会话中。</p><h3 id="在Mac上使用粘贴板">在Mac上使用粘贴板</h3><p>我们都知道，Mac自带 pbcopy 和 pbpaste命令，分别用于复制和粘贴，但在tmux命令中它们却不能正常运行。这里我将详细介绍下原因：</p><blockquote><p>Mac的粘贴板服务是在引导命名空间注册的。命名空间存在层次之分，更高级别的命名空间拥有访问低级别命名空间（如root引导命名空间）的权限，反之却不行。流程创建的属于Mac登录会话的一部分，它会被自动包含在用户级的引导命名空间中，因此只有用户级的命名空间才能访问粘贴板服务。tmux使用守护进程(3)库函数创建其服务器进程，在Mac OS X 10.5中，苹果改变了守护进程(3)的策略，将生成的过程从最初的引导命名空间移到了根引导命名空间。而根引导命名空间访问权限较低，这意味着tmux服务器，和它的子进程，一同失去了原引导命名空间的访问权限（即无权限访问粘贴板服务）。</p></blockquote><p>如此，我们可以使用一个小小的包装程序来重新连接到合适的命名空间，然后执行访问用户级命名空间的粘贴板服务，这个包装程序就是reattach-to-user-namespace。</p><p>那么，Mac下.tmux.conf的配置如下：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">buffer缓存复制到Mac系统粘贴板</span></span><br><span class="line">bind C-c run &quot;tmux save-buffer - | reattach-to-user-namespace pbcopy&quot;</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Mac系统粘贴板内容复制到会话</span></span><br><span class="line">bind C-v run &quot;reattach-to-user-namespace pbpaste | tmux load-buffer - \; paste-buffer -d&quot;</span><br></pre></td></tr></table></figure><p>reattach-to-user-namespace 作为包装程序来访问Mac粘贴板，按下<code>Ctrl+b Ctrl+c</code> 键，buffer缓存的内容将复制到粘贴板，按下<code>Ctrl+b Ctrl+v</code>键，粘贴板的内容将通过 load-buffer 加载，然后由 paste-buffer 粘贴到tmux会话中。</p><p>为了在复制模式中使用Mac系统的粘贴板，可做如下配置：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">绑定y键为复制选中文本到Mac系统粘贴板</span></span><br><span class="line">bind-key -T copy-mode-vi &#x27;y&#x27; send-keys -X copy-pipe-and-cancel &#x27;reattach-to-user-namespace pbcopy&#x27;</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">鼠标拖动选中文本，并复制到Mac系统粘贴板</span></span><br><span class="line">bind-key -T copy-mode-vi MouseDragEnd1Pane send -X copy-pipe-and-cancel &quot;pbcopy&quot;</span><br></pre></td></tr></table></figure><p>完成以上配置后记得重启tmux服务器。至此，复制模式中，按y键将保存选中的文本到Mac系统粘贴板，随后按Command + v键便可粘贴。</p><h1 id="保存Tmux会话">保存Tmux会话</h1><p>tmux保护现场的能力依赖于tmux进程，如果进程退出，则意味着会话数据的丢失，因此关机重启后，tmux中的会话将被清空，这不是我们想要见到的。幸运的是，目前有这样两款插件：Tmux Resurrect 和 Tmux Continuum，可以永久保存tmux会话（它们均适用于tmux v1.9及以上版本）。</p><h2 id="Tmux-Resurrect">Tmux Resurrect</h2><p>Tmux Resurrect无须任何配置，就能够备份tmux会话中的各种细节，包括窗口、面板的顺序、布局、工作目录，运行程序等等数据。因此它能在系统重启后完全地恢复会话。由于其幂等的恢复机制，它不会试图去恢复一个已经存在的窗口或者面板，所以，即使你不小心多恢复了几次会话，它也不会出现问题，这样主动恢复时我们就不必担心手抖多按了一次。另外，如果你是tmuxinator用户，我也建议你迁移到 tmux-resurrect插件上来，具体请参考<a target="_blank" rel="noopener" href="https://github.com/tmux-plugins/tmux-resurrect/blob/master/docs/migrating_from_tmuxinator.md#migrating-from-tmuxinator">Migrating from tmuxinator</a>。</p><p>Tmux Resurrec安装过程如下所示：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd ~/.tmux</span><br><span class="line">mkdir plugins</span><br><span class="line">git clone https://github.com/tmux-plugins/tmux-resurrect.git</span><br></pre></td></tr></table></figure><p>安装后需在~/.tmux.conf中增加一行配置：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run-shell ~/.tmux/plugins/tmux-resurrect/resurrect.tmux</span><br></pre></td></tr></table></figure><p>至此安装成功，重载tmux配置。</p><p>Tmux Resurrec提供如下两个操作：</p><ul><li>保存，快捷指令是<code>Ctrl+b Ctrl+s</code>，tmux状态栏在保存开始，保存后分别提示”Saving…”，”Tmux environment saved !”。</li><li>恢复，快捷指令是<code>Ctrl+b Ctrl+r</code>，tmux状态栏在恢复开始，恢复后分别提示”Restoring…”，”Tmux restore complete !”。</li></ul><p>保存时，tmux会话的详细信息会以文本文件的格式保存到~/.tmux/resurrect目录，恢复时则从此处读取，由于数据文件是明文的，因此你完全可以自由管理或者编辑这些会话状态文件（如果备份频繁，记得定期清除历史备份）。</p><h3 id="可选的配置">可选的配置</h3><p>Tmux Resurrec本身是免配置开箱即用的，但同时也提供了如下选项以便修改其默认设置。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">set -g @resurrect-save &#x27;S&#x27; # 修改保存指令为S</span><br><span class="line">set -g @resurrect-restore &#x27;R&#x27; 修改恢复指令为R</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">修改会话数据的保持路径，此处不能使用除了<span class="variable">$HOME</span>, <span class="variable">$HOSTNAME</span>, ~之外的环境变量</span></span><br><span class="line">set -g @resurrect-dir &#x27;/some/path&#x27;</span><br></pre></td></tr></table></figure><p>默认情况下只有一个保守的列表项（即vi vim nvim emacs man less more tail top htop irssi mutt）可以恢复，对此 Restoring programs doc 解释了怎么去恢复额外的项目。</p><h3 id="进阶的备份">进阶的备份</h3><p>除了基础备份外，Tmux Resurrec还提供进阶的备份功能，如下所示：</p><ul><li>恢复vim 和 neovim 会话</li><li>恢复面板内容</li><li>恢复shell的历史记录（实验性功能）</li></ul><p>进阶的备份功能默认不开启，需要特别配置。</p><ol><li>恢复vim 和 neovim 会话，需要完成如下两步：</li></ol><p>通过vim的vim-obsession插件保存vim/neovim会话。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd ~/.vim/bundle</span><br><span class="line">git clone git://github.com/tpope/vim-obsession.git</span><br><span class="line">vim -u NONE -c &quot;helptags vim-obsession/doc&quot; -c q</span><br></pre></td></tr></table></figure><p>在~/.tmux.conf中增加两行配置：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">set -g @resurrect-strategy-vim &#x27;session&#x27; # for vim</span><br><span class="line">set -g @resurrect-strategy-nvim &#x27;session&#x27; # for neovim</span><br></pre></td></tr></table></figure><ol start="2"><li>恢复面板内容，需在~/.tmux.conf中增加一行配置：</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">set -g @resurrect-capture-pane-contents &#x27;on&#x27; # 开启恢复面板内容功能</span><br></pre></td></tr></table></figure><p>目前使用该功能时，请确保tmux的default-command没有包含&amp;&amp; 或者||操作符，否则将导致bug。（查看default-command的值，请使用命令tmux show -g default-command。）</p><ol start="3"><li>恢复shell的历史记录，需在~/.tmux.conf中增加一行配置：</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">set -g @resurrect-save-shell-history &#x27;on&#x27;</span><br></pre></td></tr></table></figure><p>由于技术的限制，保存时，只有无前台任务运行的面板，它的shell历史记录才能被保存。</p><h2 id="Tmux-Continuum">Tmux Continuum</h2><p>可能你嫌手动保存和恢复太过麻烦，别担心，这不是问题。Tmux Continuum 在 Tmux Resurrec的基础上更进一步，现在保存和恢复全部自动化了，如你所愿，可以无感使用tmux，不用再担心备份问题。</p><p>Tmux Continuum安装过程如下所示（它依赖Tmux Resurrect，请保证已安装Tmux Resurrect插件）：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd ~/.tmux/plugins</span><br><span class="line">git clone https://github.com/tmux-plugins/tmux-continuum.git</span><br></pre></td></tr></table></figure><p>安装后需在~/.tmux.conf中增加一行配置：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run-shell ~/.tmux/plugins/tmux-continuum/continuum.tmux</span><br></pre></td></tr></table></figure><p>Tmux Continuum默认每隔15mins备份一次，我设置的是一天一次：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">set -g @continuum-save-interval &#x27;1440&#x27;</span><br></pre></td></tr></table></figure><p>关闭自动备份，只需设置时间间隔为 0 即可：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">set -g @continuum-save-interval &#x27;0&#x27;</span><br></pre></td></tr></table></figure><p>想要在tmux启动时就恢复最后一次保存的会话环境，需增加如下配置：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">set -g @continuum-restore &#x27;on&#x27; # 启用自动恢复</span><br></pre></td></tr></table></figure><p>如果不想要启动时自动恢复的功能了，直接移除上面这行就行。想要绝对确定自动恢复不会发生，就在用户根目录下创建一个tmux_no_auto_restore空文件（创建命令：touch ~/tmux_no_auto_restore），该文件存在时，自动恢复将不触发。</p><p>对于tmux高级用户（可能就是你）而言，同时运行多个tmux服务器也是有可能的。你可能并不希望后面启用的几个tmux服务器自动恢复或者自动保存会话。因此Tmux Continuum会优先在第一个启用的tmux服务器中生效，随后启用的tmux服务器不再享受自动恢复或自动保存会话的待遇。</p><p>实际上，不管Tmux Continuum功能有没有启用，或者多久保存一次，我们都有办法从状态栏知晓。Tmux Continuum提供了一个查看运行状态的插值#{continuum_status}，它支持status-right 和 status-left两种状态栏设置，如下所示：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">set -g status-right &#x27;Continuum status: #&#123;continuum_status&#125;&#x27;</span><br></pre></td></tr></table></figure><p>tmux运行时，#{continuum_status} 将显示保存的时间间隔（单位为分钟），此时状态栏会显示：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Continuum status: 1440</span><br></pre></td></tr></table></figure><p>如果其自动保存功能关闭了，那么状态栏会显示：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Continuum status: off</span><br></pre></td></tr></table></figure><p>借助Tmux Continuum插件，Mac重启时，我们甚至可以选择在Terminal 或者 iTerm2 中自动全屏启用tmux。</p><p>为此，需在~/.tmux.conf中增加一行配置：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">set -g @continuum-boot &#x27;on&#x27;</span><br></pre></td></tr></table></figure><p>Mac下，自动启用tmux还支持如下选项：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">set -g @continuum-boot-options &#x27;fullscreen&#x27; ，Terminal自动全屏，tmux命令在Terminal中执行。</span><br><span class="line">set -g @continuum-boot-options &#x27;iterm&#x27; ， iTerm2 替换 Terminal 应用，tmux命令在iTerm2中执行。</span><br><span class="line">set -g @continuum-boot-options &#x27;iterm,fullscreen&#x27;，iTerm2自动全屏，tmux命令在iTerm2中执行。</span><br></pre></td></tr></table></figure><p>Linux中则没有这些选项，它只能设置为自动启用tmux服务器。</p><h2 id="TPM">TPM</h2><p>以上，我们直接安装了tmux插件。这没有问题，可当插件越来越多时，我们就会需要统一的插件管理器。因此官方提供了tpm（支持tmux v1.9及以上版本）。</p><p>tpm安装过程如下所示：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd ~/.tmux/plugins</span><br><span class="line">git clone https://github.com/tmux-plugins/tpm</span><br></pre></td></tr></table></figure><p>安装后需在~/.tmux.conf中增加如下配置：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">默认需要引入的插件</span></span><br><span class="line">set -g @plugin &#x27;tmux-plugins/tpm&#x27;</span><br><span class="line">set -g @plugin &#x27;tmux-plugins/tmux-sensible&#x27;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">引入其他插件的示例</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">set</span> -g @plugin <span class="string">&#x27;github_username/plugin_name&#x27;</span> <span class="comment"># 格式：github用户名/插件名</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">set</span> -g @plugin <span class="string">&#x27;git@github.com/user/plugin&#x27;</span> <span class="comment"># 格式：git@github插件地址</span></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">初始化tmux插件管理器(保证这行在~/.tmux.conf的非常靠后的位置)</span></span><br><span class="line">run &#x27;~/.tmux/plugins/tpm/tpm&#x27;</span><br></pre></td></tr></table></figure><p>然后重载tmux配置，使得tpm生效。</p><p>基于tpm插件管理器，安装插件仅需如下两步：</p><ol><li>在~/.tmux.conf中增加新的插件，如set -g @plugin ‘…’。</li><li>按下<code>Ctrl+b I</code>键下载插件，并刷新tmux环境。</li></ol><p>更新插件，请按下<code>Ctrl+b U</code> 键，选择待更新的插件后，回车确认并更新。</p><p>卸载插件，需如下两步：</p><ol><li>在~/.tmux.conf中移除插件所在行。</li><li>按下<code>Ctrl+b alt + u</code> 移除插件。</li></ol><h1 id="会话共享">会话共享</h1><p>tmux多会话连接实时同步的功能，使得结对编程成为了可能，这也是开发者最喜欢的功能之一。现在就差一步了，就是借助tmate把tmux会话分享出去。</p><p>tmate是tmux的管理工具，它可以轻松的创建tmux会话，并且自动生成ssh链接。</p><p>安装tmate</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install tmate</span><br></pre></td></tr></table></figure><p>使用tmate新建一个tmux会话</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tmate</span><br></pre></td></tr></table></figure><p>查看tmate生成的ssh链接</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tmate show-messages</span><br></pre></td></tr></table></figure><h2 id="共享账号-组会话">共享账号&amp;组会话</h2><p>使用tmate远程共享tmux会话，受制于多方的网络质量，必然会存在些许延迟。如果共享会话的多方拥有同一个远程服务器的账号，那么我们可以使用组会话解决这个问题。</p><p>先在远程服务器上新建一个公共会话，命名为groupSession。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tmux new -s groupSession</span><br></pre></td></tr></table></figure><p>其他用户不去直接连接这个会话，而是通过创建一个新的会话来加入上面的公共会话groupSession。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tmux new -t groupSession -s otherSession</span><br></pre></td></tr></table></figure><p>此时两个用户都可以在同一个会话里操作，就会好像第二个用户连接到了groupSession的会话一样。此时两个用户都可以创建新建的窗口，新窗口的内容依然会实时同步，但是其中一个用户切换到其它窗口，对另外一个用户没有任何影响，因此在这个共享的组会话中，用户各自的操作可以通过新建窗口来执行。即使第二个用户关闭otherSession会话，共享会话groupSession依然存在。</p><p>组会话在共享的同时，又保留了相对的独立，非常适合结对编程场景，它是结对编程最简单的方式，如果账号不能共享，我们就要使用下面的方案了。</p><h2 id="独立账号-Socket共享会话">独立账号&amp;Socket共享会话</h2><p>开始之前我们需要确保用户对远程服务器上同一个目录拥有相同的读写权限，假设这个目录为/var/tmux/。</p><p>使用new-session（简写new）创建会话时，使用的是默认的socket位置，默认socket无法操作，所以我们需要创建一个指定socket文件的会话。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tmux -S /var/tmux/sharefile</span><br></pre></td></tr></table></figure><p>另一个用户进入时，需要指定socket文件加入会话。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tmux -S /var/tmux/sharefile attach</span><br></pre></td></tr></table></figure><p>这样，两个不同的用户就可以共享同一个会话了。</p><p>通常情况下，不同的用户使用不同的配置文件来创建会话，但是，使用指定socket文件创建的tmux会话，会话加载的是第一个创建会话的用户的~/.tmux.conf配置文件，随后加入会话的其他用户，依然使用同一份配置文件。</p><h1 id="Tmux优化">Tmux优化</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">设置窗口面板起始序号</span></span><br><span class="line">set -g base-index 1 # 设置窗口的起始下标为1</span><br><span class="line">set -g pane-base-index 1 # 设置面板的起始下标为1</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">自定义状态栏</span></span><br><span class="line">set -g status-utf8 on # 状态栏支持utf8</span><br><span class="line">set -g status-interval 1 # 状态栏刷新时间</span><br><span class="line">set -g status-justify left # 状态栏列表左对齐</span><br><span class="line">setw -g monitor-activity on # 非当前窗口有内容更新时在状态栏通知</span><br><span class="line"></span><br><span class="line">set -g status-bg black # 设置状态栏背景黑色</span><br><span class="line">set -g status-fg yellow # 设置状态栏前景黄色</span><br><span class="line">set -g status-style &quot;bg=black, fg=yellow&quot; # 状态栏前景背景色</span><br><span class="line"></span><br><span class="line">set -g status-left &quot;#[bg=#FF661D] ❐ #S &quot; # 状态栏左侧内容</span><br><span class="line">set -g status-right &#x27;Continuum status: #&#123;continuum_status&#125;&#x27; # 状态栏右侧内容</span><br><span class="line">set -g status-left-length 300 # 状态栏左边长度300</span><br><span class="line">set -g status-right-length 500 # 状态栏左边长度500</span><br><span class="line"></span><br><span class="line">set -wg window-status-format &quot; #I #W &quot; # 状态栏窗口名称格式</span><br><span class="line">set -wg window-status-current-format &quot; #I:#W#F &quot; # 状态栏当前窗口名称格式(#I：序号，#w：窗口名称，#F：间隔符)</span><br><span class="line">set -wg window-status-separator &quot;&quot; # 状态栏窗口名称之间的间隔</span><br><span class="line">set -wg window-status-current-style &quot;bg=red&quot; # 状态栏当前窗口名称的样式</span><br><span class="line">set -wg window-status-last-style &quot;fg=red&quot; # 状态栏最后一个窗口名称的样式</span><br><span class="line"></span><br><span class="line">set -g message-style &quot;bg=#202529, fg=#91A8BA&quot; # 指定消息通知的前景、后景色</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">tmux中使用vim编辑器，文本内容的配色和直接使用vim时有些差距，此时需要开启256 colors的支持，配置如下。</span></span><br><span class="line">set -g default-terminal &quot;screen-256color&quot;</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">或者</span></span><br><span class="line">set -g default-terminal &quot;tmux-256color&quot;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">关闭默认的rename机制</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">tmux默认会自动重命名窗口，频繁的命令行操作，将频繁触发重命名，比较浪费CPU性能，性能差的计算机上，问题可能更为明显。建议添加如下配置关闭rename机制。</span></span><br><span class="line"></span><br><span class="line">setw -g automatic-rename off</span><br><span class="line">setw -g allow-rename off</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>tmux默认会同步同一个会话的操作到所有会话连接的终端窗口中，这种同步机制，限制了窗口的大小为最小的会话连接。因此当你开一个大窗口去连接会话时，实际的窗口将自动调整为最小的那个会话连接的窗口，终端剩余的空间将填充排列整齐的小圆点.为了避免这种问题，我们可以在连接会话的时候，断开其他的会话连接。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tmux a -d</span><br></pre></td></tr></table></figure><p>如果已经进入了tmux会话中，才发现这种问题，这个时候可以输入命令达到同样的效果。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Ctrl+b : a -d</span><br></pre></td></tr></table></figure><h1 id="脚本化的Tmux">脚本化的Tmux</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/usr/bin/env sh</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">tmux path</span></span><br><span class="line">cmd=$(which tmux) </span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">session name</span></span><br><span class="line">session=codefun   </span><br><span class="line"></span><br><span class="line">if [ -z $cmd ]; then</span><br><span class="line">  echo &quot;You need to install tmux.&quot;</span><br><span class="line">  exit 1</span><br><span class="line">fi</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">cmd has -t <span class="variable">$session</span></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">session 是否存在</span></span><br><span class="line">if [ $? != 0 ]; then</span><br><span class="line"><span class="meta prompt_">  # </span><span class="language-bash">create a new tmux session, starting vim from a saved session <span class="keyword">in</span> the new window</span></span><br><span class="line"><span class="meta prompt_">  $</span><span class="language-bash">cmd new-session -d -s <span class="variable">$session</span> -n vim <span class="comment">#&quot;vim -S ~/.vim/sessions/kittybusiness&quot;</span></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">  # </span><span class="language-bash">Select pane 1, <span class="built_in">set</span> <span class="built_in">dir</span> to api, run vim</span></span><br><span class="line"><span class="meta prompt_">  $</span><span class="language-bash">cmd selectp -t 1</span> </span><br><span class="line"><span class="meta prompt_">  $</span><span class="language-bash">cmd send-keys <span class="string">&quot;api;vim&quot;</span> C-m</span> </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">  # </span><span class="language-bash">Split pane 1 horizontal by 65%, start redis-server</span></span><br><span class="line"><span class="meta prompt_">  $</span><span class="language-bash">cmd splitw -h -p 35</span></span><br><span class="line"><span class="meta prompt_">  $</span><span class="language-bash">cmd send-keys <span class="string">&quot;redis-server&quot;</span> C-m</span> </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">  # </span><span class="language-bash">Select pane 2</span> </span><br><span class="line"><span class="meta prompt_">  $</span><span class="language-bash">cmd selectp -t 2</span></span><br><span class="line"><span class="meta prompt_">  # </span><span class="language-bash">Split pane 2 vertiacally by 25%</span></span><br><span class="line"><span class="meta prompt_">  $</span><span class="language-bash">cmd splitw -v -p 75</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">  # </span><span class="language-bash"><span class="keyword">select</span> pane 3, <span class="built_in">set</span> to api root</span></span><br><span class="line"><span class="meta prompt_">  $</span><span class="language-bash">cmd selectp -t 3</span></span><br><span class="line"><span class="meta prompt_">  $</span><span class="language-bash">cmd send-keys <span class="string">&quot;api&quot;</span> C-m</span> </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">  # </span><span class="language-bash">Select pane 1</span></span><br><span class="line"><span class="meta prompt_">  $</span><span class="language-bash">cmd selectp -t 1</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">  # </span><span class="language-bash">create a new window called scratch</span></span><br><span class="line"><span class="meta prompt_">  $</span><span class="language-bash">cmd new-window -t <span class="variable">$session</span>:1 -n scratch</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">  # </span><span class="language-bash"><span class="built_in">return</span> to main vim window</span></span><br><span class="line"><span class="meta prompt_">  $</span><span class="language-bash">cmd select-window -t <span class="variable">$session</span>:0</span></span><br><span class="line">fi</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">加载session</span></span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">cmd att -t <span class="variable">$session</span></span></span><br></pre></td></tr></table></figure><h2 id="tmux-实现平铺视图">tmux 实现平铺视图</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/sh</span></span><br><span class="line"></span><br><span class="line">USERNAME=&quot;$USER&quot;</span><br><span class="line">SUFFIXNAME=&#x27;tmux&#x27;</span><br><span class="line">WINDOWNAME=&#x27;dashboard&#x27;</span><br><span class="line">panes=( &#x27;1&#x27; &#x27;2&#x27; &#x27;3&#x27; &#x27;4&#x27; &#x27;5&#x27; &#x27;6&#x27; &#x27;7&#x27; &#x27;8&#x27; &#x27;9&#x27; &#x27;10&#x27;)</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">########################### USER DEFINE PARAM END #####################################</span></span></span><br><span class="line"></span><br><span class="line">tmux_dir=$(cd $(dirname $0);pwd)</span><br><span class="line"></span><br><span class="line">session=&quot;$USERNAME-$SUFFIXNAME&quot;</span><br><span class="line"></span><br><span class="line">tmux has-session -t $session 2&gt;/dev/null</span><br><span class="line"></span><br><span class="line">if [ $? != 0 ]; then</span><br><span class="line">    echo &quot;init tmux session $session&quot;</span><br><span class="line">    # 创建session</span><br><span class="line">	tmux new-session -d -s $session</span><br><span class="line">    tmux source &quot;$&#123;tmux_dir&#125;/tmux.conf&quot;</span><br><span class="line"></span><br><span class="line">    tmux  rename-window &quot;$WINDOWNAME-$window_index&quot;</span><br><span class="line">    tmux  select-window -t  $session:0</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    length=$&#123;#panes[@]&#125;</span><br><span class="line">    for i in &quot;$&#123;!panes[@]&#125;&quot;; </span><br><span class="line">    do </span><br><span class="line">        pane_index=$((i+1))</span><br><span class="line">        printf &quot;try init pane %s , pane index[%s]\n&quot; &quot;$&#123;panes[$i]&#125;&quot; &quot;$pane_index&quot;</span><br><span class="line">        window_index=0</span><br><span class="line">        if [ $((pane_index%4)) -eq 1 ]; then</span><br><span class="line">            echo &quot;Pane $&#123;panes[$i]&#125; create success&quot; </span><br><span class="line">            tmux  send-keys &quot; clear&quot; C-m</span><br><span class="line">            tmux  send-keys &quot; echo pane $&#123;panes[$i]&#125;&quot; C-m</span><br><span class="line">        else</span><br><span class="line">            echo &quot;Pane $&#123;panes[$i]&#125; create success&quot;  </span><br><span class="line">            tmux  split-window</span><br><span class="line">            tmux  send-keys &quot; clear&quot; C-m</span><br><span class="line">            tmux  send-keys &quot; echo pane $&#123;panes[$i]&#125;&quot; C-m</span><br><span class="line">        fi</span><br><span class="line">        # 判断是否能被4整除</span><br><span class="line">        if [ $((pane_index%4)) -eq 0 ] ; then</span><br><span class="line">            tmux select-layout  tiled</span><br><span class="line">            window_index=$((pane_index/4))</span><br><span class="line">            if [ $pane_index -eq $length ] ;then</span><br><span class="line">                echo &quot;pane end, no need create window&quot;</span><br><span class="line">            else</span><br><span class="line">                echo &quot;create window: $WINDOWNAME-$window_index&quot;</span><br><span class="line">                tmux new-window -n &quot;$WINDOWNAME-$window_index&quot;</span><br><span class="line">                tmux select-window -t  $session:$window_index</span><br><span class="line">            fi</span><br><span class="line">        fi</span><br><span class="line">    done</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line">echo &quot;attach tmux session $session&quot;</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">挂载</span></span><br><span class="line">tmux attach -t $session</span><br></pre></td></tr></table></figure><blockquote><p>每4次split-window后要执行一次<code>tmux select-layout tiled</code>。</p></blockquote></div><footer class="post-footer"><div class="reward-container"><div>请我一杯咖啡吧！</div><button>赞赏</button><div class="post-reward"><div><img src="/images/weixinpay.webp" alt="Victor Chu 微信"> <span>微信</span></div><div><img src="/images/alpay.webp" alt="Victor Chu 支付宝"> <span>支付宝</span></div></div></div><div class="post-copyright"><ul><li class="post-copyright-author"><strong>本文作者： </strong>Victor Chu</li><li class="post-copyright-link"><strong>本文链接：</strong> <a href="https://www.victorchu.info/posts/85f7767b/" title="linux命令tumx">https://www.victorchu.info/posts/85f7767b/</a></li><li class="post-copyright-license"><strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！</li></ul></div><div class="followme"><span>欢迎关注我的其它发布渠道</span><div class="social-list"><div class="social-item"><a target="_blank" class="social-link" href="/atom.xml"><span class="icon"><i class="fa fa-rss"></i> </span><span class="label">RSS</span></a></div><div class="social-item"><a target="_blank" class="social-link" href="/images/wechat_channel.webp"><span class="icon"><i class="fab fa-weixin"></i> </span><span class="label">WeChat</span></a></div></div></div><div class="post-tags"><a href="/tags/Shell/" rel="tag"><i class="fa fa-tag"></i> Shell</a> <a href="/tags/Command/" rel="tag"><i class="fa fa-tag"></i> Command</a></div><div class="post-nav"><div class="post-nav-item"><a href="/posts/d177193b/" rel="prev" title="linux命令free"><i class="fa fa-angle-left"></i> linux命令free</a></div><div class="post-nav-item"><a href="/posts/3a1678d4/" rel="next" title="linux命令top">linux命令top <i class="fa fa-angle-right"></i></a></div></div></footer></article></div><div class="comments" id="waline"></div></div></main><footer class="footer"><div class="footer-inner"><div class="beian"><a href="https://beian.miit.gov.cn/" rel="noopener" target="_blank">浙ICP备18037908号-1 </a><img src="/images/gongan_icon.webp" alt=""><a href="https://beian.mps.gov.cn/#/query/webSearch?code=33010902002043" rel="noopener" target="_blank">浙公网安备 33010902002043号</a></div><div class="copyright">&copy; 2016 – <span itemprop="copyrightYear">2024</span> <span class="with-love"><i class="fa fa-heart"></i> </span><span class="author" itemprop="copyrightHolder">Victor Chu</span></div><div class="wordcount"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-chart-line"></i> </span><span title="站点总字数">1.8m</span> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-coffee"></i> </span><span title="站点阅读时长">49:45</span></span></div><div class="powered-by">由<a href="https://www.upyun.com/?utm_source=lianmeng&utm_medium=referral" class="theme-link" rel="noopener" target="_blank"><img src="/images/upyun_logo.webp" width="50" style="display:inline"></a>提供CDN服务</div></div></footer><div class="toggle sidebar-toggle" role="button"><span class="toggle-line"></span> <span class="toggle-line"></span> <span class="toggle-line"></span></div><div class="sidebar-dimmer"></div><div class="reading-progress-bar"></div><a role="button" class="book-mark-link book-mark-link-fixed"></a><noscript><div class="noscript-warning">Theme NexT works best with JavaScript enabled</div></noscript><script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fancyapps-ui/5.0.31/fancybox/fancybox.umd.js" integrity="sha256-a+H7FYzJv6oU2hfsfDGM2Ohw/cR9v+hPfxHCLdmCrE8=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/lozad.js/1.16.0/lozad.min.js" integrity="sha256-mOFREFhqmHeQbXpK2lp4nA3qooVgACfh88fpJftLBbc=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/pangu/4.0.7/pangu.min.js" integrity="sha256-j+yj56cdEY2CwkVtGyz18fNybFGpMGJ8JxG3GSyO2+I=" crossorigin="anonymous"></script><script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/sidebar.js"></script><script src="/js/next-boot.js"></script><script src="/js/bookmark.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/algoliasearch/4.23.3/algoliasearch-lite.umd.js" integrity="sha256-1QNshz86RqXe/qsCBldsUu13eAX6n/O98uubKQs87UI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/instantsearch.js/4.67.0/instantsearch.production.min.js" integrity="sha256-TW7D3X/i/W+RUgEeDppEnFT2ixv5lzplKH0c58D92dY=" crossorigin="anonymous"></script><script src="/js/third-party/search/algolia-search.js"></script><script class="next-config" data-name="mermaid" type="application/json">{"enable":true,"theme":"default","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mermaid/10.9.0/mermaid.min.js","integrity":"sha256-stuqcu2FrjYCXDOytWFA5SoUE/r3nkp6gTglzNSlavU="}}</script><script src="/js/third-party/tags/mermaid.js"></script><script src="/js/third-party/fancybox.js"></script><script class="next-config" data-name="enableMath" type="application/json">false</script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css" integrity="sha256-UF1fgpAiu3tPJN/uCqEUHNe7pnr+QR0SQDNfgglgtcM=" crossorigin="anonymous"><script class="next-config" data-name="waline" type="application/json">{"lang":"zh-cn","enable":true,"serverURL":"walineui.victorchu.info","cssUrl":"https://cdn.staticfile.org/waline/2.15.8/waline.css","commentCount":true,"pageview":true,"requiredMeta":["nick","mail"],"login":"force","libUrl":"https://cdn.staticfile.org/waline/2.15.8/waline.js","el":"#waline","comment":true,"path":"/posts/85f7767b/"}</script><link rel="stylesheet" href="https://cdn.staticfile.org/waline/2.15.8/waline.css"><script>document.addEventListener('page:loaded', () => {
  NexT.utils.loadComments(CONFIG.waline.el).then(() =>
    NexT.utils.getScript(CONFIG.waline.libUrl, { condition: window.Waline })
  ).then(() => 
    Waline.init(Object.assign({}, CONFIG.waline,{ el: document.querySelector(CONFIG.waline.el) }))
  );
});</script></body></html>